window.__require=function e(t,n,o){function i(a,c){if(!n[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var u="function"==typeof __require&&__require;if(!c&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){return i(t[a][1][e]||e)},p,p.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({API:[function(e,t,n){"use strict";cc._RF.push(t,"3dd7c8EvwhEA5sLJddBRrcN","API"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=(o.ccclass,o.property,function(){function e(){}return e.getState=function(){console.log("\u83b7\u53d6\u4fe1\u606f")},e.vibration=function(e){console.log("\u8c03\u7528\u632f\u52a8",e)},e.mute=function(e){console.log("\u8c03\u7528\u9759\u97f3",e)},e.fullAD=function(e){console.log("\u8c03\u7528\u5168\u5c4f\u5e7f\u544a"),e.succes&&e.succes()},e.extra=function(e){console.log("\u8c03\u7528\u5145\u503c\u63a5\u53e3"),e.succes&&e.succes()},e}());n.default=i,cc._RF.pop()},{}],Boss:[function(e,t,n){"use strict";cc._RF.push(t,"3cb229rGPpMlK7XA8XUfPdI","Boss");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.bossBox=n.BossComp=void 0;var s=e("../../Common"),u=e("../../core/LoadRes"),p=e("../../data/dataManager"),f=e("../gameManager"),l=Math.PI/180,d=180/Math.PI,h=function(){function e(e,t){this.node=new cc.Node("boss"+e),this.node.active=!0,this.node.setContentSize(0,0),this.init(e,t)}return e.prototype.init=function(e,t){return a(this,void 0,void 0,function(){var n,o,i,r,a,s,p,l,d,h,g,y,b,_,P,w=this;return c(this,function(c){switch(c.label){case 0:return this.head=new cc.Node("head"),this.head.group="boss",n=this.head.addComponent(cc.Sprite),i=(o=cc.SpriteFrame).bind,[4,u.default.get("Texture/role/boss/boss_head_"+e,cc.Texture2D)];case 1:return n.spriteFrame=new(i.apply(o,[void 0,c.sent()])),(r=new cc.Node("body")).group="boss",a=r.addComponent(cc.Sprite),p=(s=cc.SpriteFrame).bind,[4,u.default.get("Texture/role/boss/boss_body_"+e,cc.Texture2D)];case 2:for(a.spriteFrame=new(p.apply(s,[void 0,c.sent()])),this.bodys=[],this.bodys.push(r);this.bodys.length<t;)this.bodys.push(cc.instantiate(r));return this.head.setParent(this.node),this.head.zIndex=this.bodys.length,this.bodys.forEach(function(e,t){e.setParent(w.node),e.name="body"+t,e.zIndex=w.bodys.length-t-1}),l=f.default.ins.canvas,d=l.width,h=l.height,g=Math.min(d,h)/2,g=Math.round(g),y=this.head,b=y.width,_=y.height,this.head.width=g,this.head.height=_*g/b,this.bodys.forEach(function(e){var t=e.width,n=e.height;e.width=.8*g,e.height=n*g*.8/t}),P=this.node.addComponent(m),this.head.addComponent(v),this.bodys.forEach(function(e){return e.addComponent(v)}),P.head=this.head,P.bodys=this.bodys,P.type=e,this.node.setParent(f.default.ins.uifight.monsterBox),[2]}})})},e}();n.default=h,window.Boss=h,console.log("Boss added window");var g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.head=null,t.updateCalls=[],t}var n;return i(t,e),n=t,Object.defineProperty(t.prototype,"target",{get:function(){var e=f.default.ins.player.node,t=e.parent.convertToWorldSpaceAR(e.position);return this.node.convertToNodeSpaceAR(t)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){n.ins=this,this.init()},t.prototype.update=function(e){f.default.ins.fight.isOver||(this.pathLength=cc.v2(this.target).sub(cc.v2(this.head.position)).mag(),this.reach=this.pathLength<10,this.reach||this.updateCalls.forEach(function(t){return t(e)}))},t.prototype.init=function(){var e=this,t=this.node.getChildByName("body"+(this.bodys.length-1));u.default.get("effect/0601",cc.Prefab).then(function(n){e.effect=cc.instantiate(n),e.effect.name="effect",e.effect.setParent(t),e.effect.active=!1});var n=new cc.Node("hp");n.color=cc.color(0,0,0),this.label=n.addComponent(cc.Label),this.label.overflow=cc.Label.Overflow.NONE,n.angle=180,this.label.font=cc.resources.get("Font/number",cc.BitmapFont),this.label.node.setParent(t),this.health=p.default.gameConf.boss_hp[this.type]/this.node.childrenCount;var o=t.getComponent(v);o.hp=this.health,o.refreshHP();var i=new cc.Node("hurtSpine");this.hurtSpine=i.addComponent(sp.Skeleton),this.hurtSpine.skeletonData=cc.resources.get("spine/jiZhong/jiZhong",sp.SkeletonData),this.hurtSpine.node.setScale(.15,.15);var r=f.default.ins.canvas,h=r.width,g=r.height;this.speed=Math.max(h,g)/10*.8;var y=4.5*this.speed/Math.max(h,g);y=Math.round(100*y)/100,this.updateCalls.push(function(t){e.trackAngle(e.head,e.target,8*t*y),e.moveForward(e.head,t)}),this.bodys.forEach(function(t){var n=parseInt(t.name.replace("body","")),o=0==n?e.head:cc.find("body"+(n-1),e.node);e.updateCalls.push(function(n){return a(e,void 0,void 0,function(){var e,i,r,a,u;return c(this,function(){return t.parent?(e=s.polarToVec(.5*o.height,o.angle*l),i=o.position.sub(cc.v3(e)),r=i.sub(t.position),a=r.angle(cc.Vec3.UP)*d,r.x>0&&(a=-a),u=t.angle,Math.abs(u-a)>180&&(u=a>u?u+360:u-360),t.angle=s.asymptotic(u,a,20*n*y),t.setPosition(t.position.lerp(i,20*n*y)),[2]):[2,void 0]})})})})},t.prototype.computeTargetAngle=function(e,t){var n=t.sub(e);if(0!=n.mag()){var o=n.angle(cc.Vec3.UP)*d;return t.x>e.x&&(o=-o),Math.round(100*o)/100}},t.prototype.trackAngle=function(e,t,n){var o=e.angle,i=this.computeTargetAngle(e.position,t);Math.abs(i-o)>180&&(i>o?o+=360:o-=360),e.angle=o,e.angle=s.asymptotic(o,i,n)},t.prototype.moveForward=function(e,t){var n=s.polarToVec(this.speed*t,this.head.angle*l),o=n.x,i=n.y;e.setPosition(e.position.add(cc.v3(o,i)))},n=r([y],t)}(cc.Component));n.BossComp=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"fontSize",{get:function(){var e;return e=t.font_width_ratio*s.Fixed(Math.min(this.node.width,this.node.height),2),Math.round(e)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this.node.addComponent(cc.CircleCollider),t=this.node,n=t.width,o=t.height;e.offset=cc.v2(0,0),e.radius=Math.min(n,o)/2},t.prototype.refreshHP=function(){m.ins.label.fontSize=this.fontSize,this.hp>0?m.ins.label.string=s.formatNum(Math.round(this.hp)):(m.ins.label.enabled=!1,this.getComponent(cc.Sprite).enabled=!1)},t.prototype.hurt=function(e){null!=this.hp&&(this.hp>e?this.hp-=e:this.hp=0,this.refreshHP(),this.hp<=0&&this.die())},t.prototype.die=function(){var e=this;this.hp=void 0;var t=m.ins.effect;t.children.forEach(function(e){var t=e.getComponent(cc.ParticleSystem);t&&t.resetSystem()});var n=cc.find("ci",t).getComponent(cc.Animation);n.on(cc.Animation.EventType.FINISHED,function(){n.off(cc.Animation.EventType.FINISHED),e.diedCall()}),t.active=!0,n.play("0601")},t.prototype.diedCall=function(){var e,n=parseInt(this.node.name.replace("body",""));e=n>0?m.ins.node.getChildByName("body"+(n-1)):m.ins.node.getChildByName("head"),m.ins.label.node.setParent(e),m.ins.label.node.setPosition(0,0),m.ins.effect.setParent(e),m.ins.effect.setPosition(0,0),m.ins.effect.active=!1;var o=e.getComponent(t);if(o.hp=m.ins.health,m.ins.label.enabled=!0,o.refreshHP(),this.node.removeFromParent(),"head"==this.node.name){var i=f.default.ins.fight;f.default.ins.uifight.setProgress(1),i.monDieCount.boss?i.monDieCount.boss++:i.monDieCount.boss=1,f.default.ins.fight.gameOver()}},t.prototype.onCollisionEnter=function(e,n){t.callGroup("enter",e,n)},t.prototype.onCollisionStay=function(e,n){t.callGroup("stay",e,n)},t.prototype.onCollisionExit=function(e,n){t.callGroup("exit",e,n)},t.callGroup=function(e,n,o){var i=t[e+"_"+n.node.group];i&&i(n,o)},t.enter_hero=function(){f.default.ins.player.die()},t.font_width_ratio=s.Fixed(22/90,2),t}(cc.Component);n.bossBox=v,cc._RF.pop()},{"../../Common":"Common","../../core/LoadRes":"LoadRes","../../data/dataManager":"dataManager","../gameManager":"gameManager"}],Buff:[function(e,t,n){"use strict";cc._RF.push(t,"437c2GMVEFNNKo42YgF2nqU","Buff");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../gameManager"),c=cc._decorator,s=c.ccclass,u=(c.property,Math.PI/180),p=(Math.PI,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.init(),this.initLanch(),this.initCollision()},t.prototype.start=function(){this.launch()},t.prototype.init=function(){this.type=this.node.name,this.speed=4.5},t.prototype.launch=function(){this._launch[this.type]()},t.prototype.goingTo=function(e){if(e){var t=e.sub(this.node.position);this.angle=cc.Vec2.UP.signAngle(cc.v2(t.x,t.y))}if(this.angle||this.speed){var n=this.getDistance();return cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).by(1,{position:n}).repeatForever()}},t.prototype.getDistance=function(){var e=a.default.ins.canvas.height/this.speed,t=e*Math.sin(this.angle*u),n=e*Math.cos(this.angle*u);return cc.v3(-t,n)},t.prototype.reflectAngle=function(e,t){var n;switch(t){case 0:n=e<0?-180:180;break;case 1:n=0;break;case 2:n=e<0?-180:180;break;case 3:n=0}return n-e},t.prototype.onCollisionEnter=function(e,t){this._collision[this.type](e,t)},t.prototype.initLanch=function(){var e=this;this._launch={excite:function(){e.angle=Math.ceil(360*Math.random()-180),e.goingTo().start()},X:function(){var t=-a.default.ins.canvas.width/10*4,n=a.default.ins.canvas.height/10*4,o=cc.v3(t,n),i=o.sub(e.node.position).mag();cc.tween(e.node).to(i/a.default.ins.canvas.height*e.speed,{position:o}).call(function(){e.node.getComponent(cc.Sprite).spriteFrame=cc.resources.get("Texture/buff/xinxin",cc.SpriteFrame)}).start()}}},t.prototype.initCollision=function(){var e=this;this._collision={excite:function(t){"wall"==t.node.group?(e.angle=e.reflectAngle(e.angle,t.tag),e.goingTo().start()):"hero"==t.node.group&&(a.default.playerComp.exciting(),a.default.recycleBuff(e))},X:function(){}}},r([s],t)}(cc.Component));n.default=p,cc._RF.pop()},{"../gameManager":"gameManager"}],Common:[function(e,t,n){"use strict";cc._RF.push(t,"92c88LFt8NIRotQbpCNlxwW","Common"),Object.defineProperty(n,"__esModule",{value:!0}),n.computedDirectionAngle=n.Fixed=n.formatNum=n.polarToVec=n.asymptotic=void 0,Math.PI;var o=180/Math.PI;n.asymptotic=function(e,t,n){var o;return o=n>=1||n<=0?t:e+(t-e)*n,Math.abs(o-t)<.01&&(o=t),Math.round(100*o)/100},n.polarToVec=function(e,t){var n=Math.sin(t)*e,o=Math.cos(t)*e;return(t>0&&n>0||t<0&&n<0)&&(n=-n),cc.v2(Math.round(100*n)/100,Math.round(100*o)/100)},n.formatNum=function(e){for(var t,n=["K","M","B"];e>999&&(t=null==t?0:t+1)!=n.length;)(e=Math.round(e/100)/10)>99.9&&(e=Math.round(e));return null==t?""+e:t>=n.length?"999 "+n[n.length-1]:e+" "+n[t]},n.Fixed=function(e,t){return(t=t||0)>10&&(t=10),t=Math.pow(10,t),Math.round(e*t)/t},n.computedDirectionAngle=function(e,t){var n=cc.v2(t),i=cc.v2(e),r=n.sub(i);if(0!=r.mag()){var a=r.angle(cc.Vec2.UP)*o;return t.x>e.x&&(a=-a),Math.round(100*a)/100}},cc._RF.pop()},{}],Init:[function(e,t,n){"use strict";cc._RF.push(t,"aca83F8ActIfZpzlNicjvdu","Init"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Scripts/core/LoadRes"),i=e("./Scripts/data/dataManager");console.log("%cversion:%cspin_master_0.0.1","color:#30ebe9; background-color:#035588; font-size:25px; font-weight:bolder; padding:0 0.5em; margin-right:0.5em; border-radius:0.5em; line-height:1em;","color:#027bfb; font-size:25px; font-weight:bolder; line-height:1em;"),o.default.get("config_json/gameConfig",cc.JsonAsset).then(function(e){return i.default.gameConf=e.json}),o.default.get("config_json/round",cc.JsonAsset).then(function(e){return i.default.roundConf=e.json}),cc._RF.pop()},{"./Scripts/core/LoadRes":"LoadRes","./Scripts/data/dataManager":"dataManager"}],LoadRes:[function(e,t,n){"use strict";cc._RF.push(t,"1b4160tNUdGFaiNANlvlnNy","LoadRes");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r="color:#3b8686; background-color:#cff09e; border:2px solid #3b8686; border-radius:0.5em; padding: 0px 0.5em; margin:0px 0.5em; font-weight:bold;",a="color:#1e2022; background-color:#c9d6de; border:2px solid #52616a; border-radius:0.5em; padding: 0px 0.5em; margin:0px 0.5em; font-weight:bold;",c=new cc.AssetManager.Cache;cc.assetManager.cacheAsset=!0;var s=function(){function e(){}return e.get=function(e,t){var n=cc.resources.get(e);return new Promise(function(o,i){n?(cc.log("\u4f7f\u7528%c\u5df2\u52a0\u8f7d%c\u7684\u9879\u76ee\u5185\u8d44\u6e90"+e,r,""),o(n)):cc.resources.load(e,t,function(t,n){t?(cc.warn("\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25",e,t),i(t)):n?(cc.log("\u4f7f\u7528%c\u672a\u52a0\u8f7d%c\u7684\u9879\u76ee\u5185\u8d44\u6e90"+e,a,""),o(n)):i("Unknow error!")})})},e.remote=function(e){var t;try{t=new URL(e).pathname}catch(n){t=e}return new Promise(function(n,o){var i=c.get(t);i?(cc.log("\u4f7f\u7528%c\u5df2\u52a0\u8f7d%c\u7684\u8d44\u6e90"+t,r,""),n(i)):(cc.log("\u4f7f\u7528%c\u672a\u52a0\u8f7d%c\u7684\u8d44\u6e90"+t,a,""),cc.assetManager.loadRemote(e,function(e,i){e?o(e):i&&(c.add(t,i),n(i))}))})},e.clearRemoteAssets=function(){return o(this,void 0,void 0,function(){return i(this,function(){return c.clear(),[2]})})},e}();n.default=s,cc._RF.pop()},{}],Loading:[function(e,t,n){"use strict";cc._RF.push(t,"29ef32ebKNJoL2OJeuUV6fl","Loading");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player_demo=null,t.progress_bar=null,t._total={},t._count={},t._over={},t}return i(t,e),Object.defineProperty(t.prototype,"total",{get:function(){var e=0;for(var t in this._total)e+=this._total[t];return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){var e=0;for(var t in this._count)e+=this._count[t];return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){var e=!0;for(var t in this._over)e=e&&this._over[t];return e},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.loadResources()},t.prototype.setProgress=function(e){e=e>1?1:e<0?0:e,this.progress_bar.progress=e;var t=this.progress_bar.getComponentInChildren(cc.Label);t.string=Math.round(1e4*e)/100+"%",t.node.parent.setPosition(t.node.parent.parent.width,t.node.parent.y)},t.prototype.demoAnimation=function(){var e=this.player_demo.getChildByName("arms"),t=150,n=360/e.childrenCount;function o(o){var r=o%=e.childrenCount,a=-o*n,c=function(){e.children[r].angle=a;var c=-r*n;c>a&&(c-=360);var s=r==(o+e.childrenCount-1)%e.childrenCount;cc.tween(e.children[r]).to((a-c)/t,{angle:c},{easing:"cubicInOut"}).call(function(t){t.angle%=360,s&&i((o+e.childrenCount-1)%e.childrenCount)}).start(),r=(r+1)%e.childrenCount};do{c()}while(r!=o)}function i(i){var r=i%=e.childrenCount,a=-i*n,c=function(){e.children[r].angle<a&&(e.children[r].angle+=360);var c=e.children[r].angle-a,s=r==(i+e.childrenCount-1)%e.childrenCount;cc.tween(e.children[r]).delay((360-n-c)/t).to(c/t,{angle:a},{easing:"cubicInOut"}).call(function(e){e.angle%=360,s&&o(i)}).start(),r=(r+1)%e.childrenCount};do{c()}while(r!=i)}o(0),cc.tween(this.player_demo.getChildByName("demo_player")).repeatForever(cc.tween().to(.8,{scale:1.2},{easing:"cubicIn"}).to(.2,{scale:1.1},{easing:"cubicOut"}).to(.2,{scale:1.2},{easing:"cubicIn"}).to(.8,{scale:1},{easing:"cubicOut"})).start()},t.prototype.loadResources=function(){var e=this;this.demoAnimation(),[{path:"Texture/role/boss",assetType:cc.SpriteFrame},{path:"Texture/role/mon",assetType:cc.SpriteFrame},{path:"config_json",assetType:cc.JsonAsset},{path:"effect",assetType:cc.Prefab},{path:"Font",assetType:cc.BitmapFont},{path:"Prefabs",assetType:cc.Prefab},{path:"Prefabs/res/list",assetType:cc.Prefab},{path:"Prefabs/view",assetType:cc.Prefab},{path:"Prefabs/view/pop",assetType:cc.Prefab},{path:"spine/HUIXIE",assetType:sp.SkeletonData},{path:"spine/jiZhong",assetType:sp.SkeletonData}].forEach(function(t){var n=t.path,o=t.assetType;e._over[n]=!1,e._count[n]=0,e._total[n]=1,cc.resources.loadDir(n,o,function(t,o){e._total[n]=o,e._count[n]=t,e._over[n]=t==o,e.setProgress(t/o),e.over&&(cc.Tween.stopAll(),cc.director.loadScene("UIMain"))},function(){})})},r([s(cc.Node)],t.prototype,"player_demo",void 0),r([s(cc.ProgressBar)],t.prototype,"progress_bar",void 0),r([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{}],Mon:[function(e,t,n){"use strict";cc._RF.push(t,"aab6djHCSZBE4SetDn4MFLc","Mon");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.MonBox=n.MonComp=void 0;var a=e("../../Common"),c=e("../../core/LoadRes"),s=e("../../data/dataManager"),u=e("../gameManager"),p=Math.PI/180,f=(Math.PI,function(){function e(){}return e.createMon=function(t){null==e.monPool[t]&&(e.monPool[t]=new cc.NodePool(h)),y.loadRes(t);var n=new cc.Node(""+t);function o(){var t=cc.instantiate(e.effect);n.addChild(t),t.active=!1,t.setPosition(0,0)}n.width=0,null==e.effect?c.default.get("effect/0601",cc.Prefab).then(function(t){e.effect=cc.instantiate(t),e.effect.name="effect",o()}):o();var i=n.addComponent(h);i.type=t;var r=n.addComponent(cc.Sprite);return r.type=cc.Sprite.Type.SIMPLE,r.spriteFrame=cc.resources.get("Texture/role/mon/"+t,cc.SpriteFrame),i.init(),n},e.get=function(t){var n=e.monPool[t];return n&&n.size()>0?n.get():e.createMon(t)},e.recycle=function(t){e.monPool[t.type].put(t.node)},e.monPool={},e}());n.default=f;var l=cc._decorator,d=l.ccclass,h=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speedSacle=1,t.updateCall=new Map,t.hurtTiemT=.4,t}var n;return i(t,e),n=t,t.angleTo=function(e,t,n){var o=e.node.angle;Math.abs(t-o)>180&&(t>o?o+=360:o-=360),e.node.angle=o,e.node.angle=a.asymptotic(o,t,n*e.rSpeed)},t.moveForward=function(e,t){var n=a.polarToVec(e.speed*t,e.node.angle*p),o=n.x,i=n.y;e.node.setPosition(e.node.position.add(cc.v3(o,i)))},t.inScreen=function(e){var t=u.default.ins.uifight.mainCamera,n=e.node.parent.convertToWorldSpaceAR(e.node.position),o=t.convertToNodeSpaceAR(n),i=o.x>t.x-t.width/2&&o.x<t.x+t.width/2,r=o.y>t.y-t.height/2&&o.y<t.y+t.height/2;return i&&r},Object.defineProperty(t,"playerP",{get:function(){var e=u.default.ins.player.node.parent.convertToWorldSpaceAR(u.default.ins.player.node.position);return u.default.ins.uifight.monsterBox.convertToNodeSpaceAR(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed*this.speedSacle},set:function(e){this._speed=e>=0?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rSpeed",{get:function(){return 1.05*this.speed},enumerable:!1,configurable:!0}),t.prototype.update=function(e){this.hp<=0||this.updateCall.forEach(function(t){return t(e)})},t.prototype.init=function(){var e=this;this.hp=s.default.gameConf.monster_hp[this.type]*s.default.fight.roundData.healthPow,this.node.addComponent(g).init(),this.updateCall.set("hurt",function(t){e.hurtTime==e.hurtTiemT?(cc.tween(e.node).repeatForever(cc.tween().to(.05,{scaleY:1.2,scaleX:.8}).to(.05,{scaleY:1,scaleX:1}).to(.05,{scaleY:.8,scaleX:1.2}).to(.05,{scaleY:1,scaleX:1})).start(),e.hurtTime-=t,e.speedSacle=.3):e.hurtTime>0?e.hurtTime-=t:(e.hurtTime=void 0,e.speedSacle=1,cc.Tween.stopAllByTarget(e.node),e.node.setScale(1,1))}),y.init(this)},t.prototype.hurt=function(e){this.hp<=0||(this.hp>e?this.hp-=e:this.hp=0,g.refreshHP(this.node),this.hp<=0?this.die():this.hurtTime=this.hurtTiemT)},t.prototype.die=function(){var e=this,t=cc.find("effect",this.node);t.children.forEach(function(e){var t=e.getComponent(cc.ParticleSystem);t&&t.resetSystem()});var n=cc.find("ci",t).getComponent(cc.Animation);n.on(cc.Animation.EventType.FINISHED,function(){n.off(cc.Animation.EventType.FINISHED),e.diedCall()}),t.active=!0,n.play("0601")},t.prototype.diedCall=function(){f.recycle(this);var e=u.default.ins.fight;e.monDieCount[this.type]?e.monDieCount[this.type]++:e.monDieCount[this.type]=1,u.default.ins.uifight.setProgress(e.allKillMonCount/e.totalMonCount),e.allKillMonCount==e.totalMonCount&&e.gameOver()},t.prototype.directionTo=function(e){var t=this;this.aimlessTime=Math.max(u.default.ins.canvas.width,u.default.ins.canvas.height)/this.speed,this.updateCall.set("to",function(o){if(t.node.angle!=e?n.angleTo(t,e,o):n.moveForward(t,o),t.aimlessTime>0)t.aimlessTime-=o;else if(""+t.type=="8"){var i=u.default.ins.uifight.monsterBox.convertToWorldSpaceAR(t.node.position),r=u.default.ins.uifight.mainCamera.convertToNodeSpaceAR(i).y>0?180:0;t.directionTo(r)}else{var c=a.computedDirectionAngle(t.node,n.playerP);t.directionTo(c)}})},t.prototype.tracking=function(e){var t=this;this.updateCall.set("to",function(o){var i=e.parent.convertToWorldSpaceAR(e.position),r=t.node.parent.convertToNodeSpaceAR(i),c=a.computedDirectionAngle(t.node,r);n.angleTo(t,c,o),n.moveForward(t,o)})},t.prototype.reuse=function(){this.node.getChildByName("effect").active=!1,this.hp=s.default.gameConf.monster_hp[this.type]*s.default.fight.roundData.healthPow,this.node.getComponent(cc.Sprite).enabled=!0,this.node.getComponentInChildren(cc.Label).enabled=!0,g.refreshHP(this.node)},t.prototype.unuse=function(){var e=this.node.getChildByName("addHP");e&&y.effectPool.addHP.put(e)},n=r([d],t)}(cc.Component));n.MonComp=h;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.addCollisionBox=function(e){e.node.group="monster";var t=e.node.addComponent(cc.CircleCollider);return t.offset=cc.v2(0,0),t.radius=Math.round(Math.max(e.node.width,e.node.height)/2),t.tag=0,t},t.sizeAdapterHP=function(e){var n,o=e.getComponent(h);if(o.hp<=t.sizeConf.hp[0])n=t.sizeConf.width[0];else{for(var i=0;o.hp>t.sizeConf.hp[i];)i++;var r=o.hp-t.sizeConf.hp[i-1],c=0,s=0;i<t.sizeConf.hp.length&&(c=t.sizeConf.width[i]-t.sizeConf.width[i-1],s=t.sizeConf.hp[i]-t.sizeConf.hp[i-1]);var u=0;0!=s&&(u=a.Fixed(r/s,4)),n=t.sizeConf.width[i-1]+Math.round(c*u)}var p=e.originSize,f=p.width,l=p.height;o.node.width=n,o.node.height=l*n/f},t.refreshHP=function(e){var n=e.getComponent(h),o=e.getComponent(t);t.sizeAdapterHP(o),o.label.fontSize=o.fontSize,n.hp>0?o.label.string=a.formatNum(Math.round(n.hp)):(o.label.enabled=!1,e.getComponent(cc.Sprite).enabled=!1),o.box.radius=Math.round(Math.max(n.node.width,n.node.height)/2)},Object.defineProperty(t.prototype,"fontSize",{get:function(){var e;return e=t.font_width_ratio*a.Fixed(this.node.width,2),Math.round(e)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.originSize=this.node.getComponent(cc.Sprite).spriteFrame.getOriginalSize();var e=new cc.Node("hp");this.label=e.addComponent(cc.Label),this.label.overflow=cc.Label.Overflow.NONE,this.node.addChild(e),e.angle=180,this.label.font=cc.resources.get("Font/number",cc.BitmapFont),this.box=t.addCollisionBox(this),t.refreshHP(this.node)},t.prototype.onCollisionEnter=function(e,n){t.callGroup("enter",e,n)},t.prototype.onCollisionExit=function(e,n){t.callGroup("exit",e,n)},t.callGroup=function(e,n,o){var i=t[e+"_"+n.node.group];i&&i(n,o)},t.enter_wall=function(){},t.enter_hero=function(e,t){0==t.tag&&u.default.ins.player.die()},t.enter_monster=function(e,t){y.enter_monster(e,t)},t.exit_monster=function(e,t){y.exit_monster(e,t)},t.width=80,t.font_width_ratio=a.Fixed(22/90,2),t.sizeConf={hp:[20,100,1e3,1e4,Math.pow(10,5),Math.pow(10,6),Math.pow(10,7),Math.pow(10,8),Math.pow(10,9)],width:[75,83,92,100,108,116,124,132,140]},t}(cc.Component);n.MonBox=g;var y=function(){function e(){}return Object.defineProperty(e,"speed",{get:function(){return null==this._s&&(this._s=Math.max(u.default.ins.canvas.width,u.default.ins.canvas.height)/10*.7),this._s},enumerable:!1,configurable:!0}),e.loadRes=function(t){""+t=="6"&&(null==e.effectPool.addHP&&(e.effectPool.addHP=new cc.NodePool),this.addHP=new cc.Node("addHP"),this.addHP.addComponent(sp.Skeleton).skeletonData=cc.resources.get("spine/HUIXIE/HUIXIE",sp.SkeletonData))},e.getEffect=function(t){var n,o=this.effectPool[t];return o&&o.size()>0?n=o.get():e[t]&&(n=cc.instantiate(e[t])),n},e.init=function(t){var n=e["init_"+t.type];n&&n(t)},e.init_1=function(t){t.speed=e.speed,t.tracking(u.default.ins.player.node)},e.init_2=function(t){e.init_1(t)},e.init_3=function(t){e.init_1(t)},e.init_4=function(t){e.init_1(t)},e.init_5=function(t){e.init_1(t)},e.init_6=function(t){e.init_1(t);var n=t.node.addComponent(cc.CircleCollider);n.offset=cc.v2(0,0),n.radius=150,n.tag=6},e.init_7=function(t){t.speed=1.5*e.speed,t.tracking(u.default.ins.player.node)},e.init_8=function(t){t.speed=e.speed,t.directionTo(180)},e.init_9=function(t){e.init_1(t)},e.init_10=function(t){t.speed=3*e.speed,t.tracking(u.default.ins.player.node)},e.init_11=function(t){e.init_1(t)},e.init_12=function(t){e.init_1(t)},e.init_13=function(t){e.init_1(t)},e.init_14=function(t){e.init_1(t)},e.init_15=function(t){e.init_10(t)},e.init_16=function(t){e.init_1(t)},e.init_17=function(t){e.init_1(t)},e.init_18=function(t){e.init_1(t)},e.init_19=function(t){e.init_1(t)},e.init_20=function(t){e.init_1(t)},e.enter_monster=function(t,n){var o=e["enter_monster_"+n.getComponent(h).type];o&&o(t,n)},e.exit_monster=function(t,n){var o=e["exit_monster_"+n.getComponent(h).type];o&&o(t,n)},e.enter_monster_6=function(t,n){if(6==n.tag){var o=t.getComponent(h),i=n.getComponent(h);if(""+o.type!="6"){var r=s.default.gameConf.monster_hp[o.type]*s.default.fight.roundData.healthPow;r*=.05,o.updateCall.set(i.uuid,function(a){if(i.hp<=0||o.hp<=0)e.exit_monster_6(t,n);else{if(!o.node.getChildByName("addHP")){var c=e.getEffect("addHP");if(c){c.setParent(o.node),c.setScale(.5);var s=c.getComponent(sp.Skeleton);s.setAnimation(0,"shengcheng",!1),s.addAnimation(0,Math.random()<.5?"huixie":"huixie2",!0)}}o.hp+=r*a,g.refreshHP(o.node)}})}}},e.exit_monster_6=function(t,n){if(6==n.tag){var o=t.getComponent(h),i=n.getComponent(h);o.updateCall.delete(i.uuid);var r=o.node.getChildByName("addHP");r&&o.hp>0&&e.effectPool.addHP.put(r)}},e.effectPool={},e}();cc._RF.pop()},{"../../Common":"Common","../../core/LoadRes":"LoadRes","../../data/dataManager":"dataManager","../gameManager":"gameManager"}],Pet:[function(e,t,n){"use strict";cc._RF.push(t,"acc457eL2lIBq9ANj0pG0UP","Pet");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../fight/bullet"),c=e("../gameManager"),s=cc._decorator,u=s.ccclass,p=(s.property,Math.PI/180),f=(Math.PI,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=6,t.ready=!1,t.bulletPool=new cc.NodePool(a.default),t.aktT=3e3,t}return i(t,e),Object.defineProperty(t.prototype,"inScreen",{get:function(){var e=c.default.ins.fight.colorMask,t=this.node.x>e.x-e.width/2&&this.node.x<e.x+e.width/2,n=this.node.y>e.y-e.height/2&&this.node.y<e.y+e.height/2;return t&&n},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.init(),this.setRandomAngle()},t.prototype.start=function(){this.knifeZhuanZhuanZhuan()},t.prototype.update=function(e){!this.inScreen&&this.ready&&this.comeToScreen(),this.shoot&&this.scanAktT(1e3*e)},t.prototype.init=function(){this.type=this.node.name,this.knifes=cc.find("knifes",this.node),this.rotation=!!this.knifes&&this.knifes.childrenCount>0,this.shoot="petMax"==this.type||!this.rotation},t.prototype.comeToScreen=function(){var e=this;if(this.ready){this.ready=!1,cc.Tween.stopAllByTarget(this.node);var t=c.default.ins.fight.colorMask.position.sub(this.node.position).mag();cc.tween(this.node).to(t/c.default.ins.canvas.height*this.speed,{position:c.default.ins.fight.colorMask.position}).call(function(){e.ready=!0,e.run()}).start()}},t.prototype.run=function(){cc.Tween.stopAllByTarget(this.node),this.angle||this.setRandomAngle();var e=this.getDistance();cc.tween(this.node).by(1,{position:e}).repeatForever().start()},t.prototype.setRandomAngle=function(e,t){void 0===e&&(e=-180),void 0===t&&(t=180);var n=Math.random()*(t-e)+e;Math.abs(n)>360&&(n%=360),n>180?n-=360:n<-180&&(n+=360),this.angle=n},t.prototype.getDistance=function(){var e=c.default.ins.canvas.height/this.speed,t=e*Math.sin(this.angle*p),n=e*Math.cos(this.angle*p);return cc.v3(t,n)},t.prototype.onCollisionEnter=function(e){this.ready&&"wall"==e.node.group&&(0==e.tag?this.setRandomAngle(90,270):1==e.tag?this.setRandomAngle(-180,0):2==e.tag?this.setRandomAngle(-90,90):3==e.tag&&this.setRandomAngle(0,180),this.run())},t.prototype.getBullet=function(){return this.bulletPool.size()<=0?c.default.ins.uifight.getBullet(this.type):this.bulletPool.get()},t.prototype.scanAktT=function(e){this.aktT-e<=0?this.Akt():this.aktT-=e},t.prototype.Akt=function(){var e=c.default.ins.fight.getRandomMonster();if(e){var t=this.getBullet();t.setParent(c.default.ins.fight.bg),t.setPosition(this.node.position),t.getComponent(a.default).target=e,t.getComponent(a.default).pet=this,t.getComponent(a.default).Akt(),this.aktT=3e3}},t.prototype.knifeZhuanZhuanZhuan=function(){this.rotation&&cc.tween(this.knifes).by(1/360*10,{angle:10}).repeatForever().start()},r([u],t)}(cc.Component));n.default=f,cc._RF.pop()},{"../fight/bullet":"bullet","../gameManager":"gameManager"}],TouchFollow:[function(e,t,n){"use strict";cc._RF.push(t,"534f5JgvPtFz5GYoMPoWHf2","TouchFollow");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../gameManager"),c=cc._decorator,s=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canto={0:!1,1:!1,2:!1,3:!1},t}return i(t,e),t.prototype.onLoad=function(){a.default.ins.touch=this},t.prototype.update=function(e){a.default.ins.fight&&null!=this.player_target_point&&this.followTouch(e)},t.prototype.run=function(){for(var e in this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this)),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove.bind(this)),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this)),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd.bind(this)),this.canto)this.canto[e]=!0;return a.default.ins.player.node.getComponent(cc.RigidBody).enabledContactListener=!0,a.default.ins.player.node.addComponent(p),Promise.resolve()},t.prototype.touchStart=function(e){if(a.default.ins.uifight.regainGameSpeed(),!a.default.ins.fight.isOver){var t=e.getLocation();this.touch_start_point=cc.v3(t),this.player_start_point=a.default.ins.player.node.position}},t.prototype.touchMove=function(e){if(!a.default.ins.fight.isOver){var t=e.getLocation(),n=cc.v3(t).sub(this.touch_start_point),o=a.default.ins.player.node.position;(!this.canto[0]&&n.y>0||!this.canto[2]&&n.y<0)&&(this.touch_start_point=cc.v3(this.touch_start_point.x,t.y),this.player_start_point=cc.v3(this.player_start_point.x,o.y),n.y=0),(!this.canto[1]&&n.x>0||!this.canto[3]&&n.x<0)&&(this.touch_start_point=cc.v3(t.x,this.touch_start_point.y),this.player_start_point=cc.v3(o.x,this.player_start_point.y),n.x=0),this.player_target_point=this.player_start_point.add(n)}},t.prototype.touchEnd=function(){a.default.ins.fight.isOver||a.default.ins.uifight.gameSlowDown()},t.prototype.followTouch=function(e){if(!a.default.ins.fight.isOver){var t=a.default.ins.player.node.position,n=this.player_target_point.sub(t),o=this.touch_start_point.sub(this.player_start_point);(!this.canto[0]&&n.y>0||!this.canto[2]&&n.y<0)&&(n.y=0,this.player_start_point=cc.v3(this.player_start_point.x,t.y),this.touch_start_point=this.player_start_point.add(o),this.player_target_point=this.player_start_point.add(n)),(!this.canto[1]&&n.x>0||!this.canto[3]&&n.x<0)&&(n.x=0,this.player_start_point=cc.v3(t.x,this.player_start_point.y),this.touch_start_point=this.player_start_point.add(o),this.player_target_point=this.player_start_point.add(n));var i=30*e;a.default.ins.player.node.setPosition(t.lerp(this.player_target_point,i>1?1:i)),this.player_target_point.sub(t).mag()<=.01&&(this.player_target_point=void 0)}},r([s],t)}(cc.Component));n.default=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){var e=this.node.addComponent(cc.CircleCollider);e.offset=cc.v2(0,0),e.radius=this.node.width/2,this.node.group="hero"},t.prototype.onCollisionEnter=function(e,t){this.callGroup("enter",e,t)},t.prototype.onCollisionStay=function(e,t){this.callGroup("stay",e,t)},t.prototype.onCollisionExit=function(e,t){this.callGroup("exit",e,t)},t.prototype.callGroup=function(e,t,n){var o=this[e+"_"+t.node.group];o?o.bind(this)(t,n):cc.warn(n.node.group+" \u4e0e "+t.node.group+" "+{enter:"\u53d1\u751f\u78b0\u649e",stay:"\u6301\u7eed\u78b0\u649e",exit:"\u78b0\u649e\u7ed3\u675f"}[e]+", \u4f46\u672a\u5728 "+n.node.group+" \u4e0a\u5904\u7406\u2026\u2026")},t.prototype.enter_wall=function(e){a.default.ins.touch.canto[e.tag]=!1},t.prototype.stay_wall=function(){},t.prototype.exit_wall=function(e){a.default.ins.touch.canto[e.tag]=!0},t.prototype.enter_monster=function(){},t}(cc.Component);cc._RF.pop()},{"../gameManager":"gameManager"}],UIFight:[function(e,t,n){"use strict";cc._RF.push(t,"5efb8VZtBlE+oAyfasDacCG","UIFight");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./core/LoadRes"),c=e("./game/fight/Buff"),s=e("./game/fight/bullet"),u=e("./game/gameManager"),p=cc._decorator,f=p.ccclass,l=p.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Demo=[],t.demoMap={},t.maps={},t.pets={},t.bulletPool={},t.buffPool={},t}return i(t,e),t.prototype.onLoad=function(){a.default.get("Prefabs/toast",cc.Prefab).then(function(e){return u.default.ins.toast=e}),u.default.ins.canvas=this.node,u.default.ins.uifight=this,this.init()},t.prototype.start=function(){var e=this;this.loadSomething().then(function(){u.default.ins.touch.run(),u.default.ins.fight.run().then(e.runCollision.bind(e))});var t=this.node.getChildByName("Main Camera");t.setContentSize(this.node.getContentSize()),this.node.on(cc.Node.EventType.SIZE_CHANGED,function(){return t.setContentSize(e.node.getContentSize())}),t.getComponentsInChildren(cc.BoxCollider).forEach(function(e){return e.node.on(cc.Node.EventType.SIZE_CHANGED,function(){return e.size=e.node.getContentSize()})})},t.prototype.init=function(){var e=this;this.mainCamera=this.node.getChildByName("Main Camera"),this.progress=this.node.getComponentInChildren(cc.ProgressBar),this.progressHandle=cc.find("bar/handle",this.progress.node),this.monsterBox=this.node.getChildByName("monsterBox"),this.mapBox=this.node.getChildByName("mapBox"),this.Demo.forEach(function(t){return e.demoMap[t.name]=cc.instantiate(t)}),this.Demo=void 0,this.demoMap.mapList.children.forEach(function(t){return e.maps[t.name]=t}),this.demoMap.mapList=void 0,this.demoMap.petList.children.forEach(function(t){return e.pets[t.name]=t}),this.demoMap.petList=void 0,this.demoMap.bulletList.children.forEach(function(t){return e.bulletPool[t.name]=new cc.NodePool(s.default)}),this.demoMap.buffList.children.forEach(function(t){return e.buffPool[t.name]=new cc.NodePool(c.default)}),this.node.opacity=0,this.setProgress(0)},t.prototype.loadSomething=function(){return new Promise(function(e){var t=0;[{path:"Prefabs/view/popUp",parent:"Main Camera"},{path:"Prefabs/player",parent:"Main Camera"}].forEach(function(n){var o=n.path,i=n.parent;t++,a.default.get(o,cc.Prefab).then(function(n){var o=cc.instantiate(n);""==i?o.setParent(u.default.ins.canvas):o.setParent(cc.find(i,u.default.ins.canvas)),0==--t&&e()})})})},t.prototype.open=function(){var e=this;return new Promise(function(t){cc.tween(e.node).to(.8,{opacity:255}).call(function(){return t()}).start()})},t.prototype.back=function(){this.stopCollision(),this.regainGameSpeed(),u.default.ins.fight.isOver=!0,u.default.clearIns(),cc.director.loadScene("UIMain")},t.prototype.gameSlowDown=function(){if(cc.kGetSpeed()>=.02){var e=this.mainCamera.getChildByName("shadow");e.active=!0,e.opacity=0,cc.Tween.stopAllByTarget(e),cc.tween(e).delay(.3).to(.5,{opacity:120},{easing:"cubicOut"}).call(function(){cc.kSpeed(.02)}).start()}},t.prototype.regainGameSpeed=function(){cc.kSpeed(1);var e=this.mainCamera.getChildByName("shadow");cc.Tween.stopAllByTarget(e),cc.tween(e).to(.5,{opacity:0},{easing:"cubicIn"}).call(function(){e.active=!1}).start()},t.prototype.setProgress=function(e){e=e>1?1:e<0?0:e,this.progress.progress=e,this.progressHandle.setPosition(this.progressHandle.parent.width,this.progressHandle.y)},t.prototype.runCollision=function(){u.default.ins.collision.enabled=!0,cc.director.getCollisionManager().enabled=!0},t.prototype.stopCollision=function(){u.default.ins.collision.enabled=!1;var e=cc.director.getCollisionManager();e.enabled=!1,e.enabledDebugDraw=!1},t.prototype.getMap=function(e){return this.maps[e]},t.prototype.getPet=function(e){return this.pets[e]},t.prototype.getBuff=function(e){return this.buffPool[e].size()>0?this.buffPool[e].get():cc.instantiate(cc.find(e,this.demoMap.buffList))},t.prototype.getBullet=function(e){return this.bulletPool[e].size()>0?this.bulletPool[e].get():cc.instantiate(cc.find(e,this.demoMap.bulletList))},t.prototype.getRandomPos=function(){var e,t=u.default.ins.canvas,n=-t.width+Math.random()*t.width*2;return Math.abs(n)<t.width/2?(e=t.height/2+Math.random()*t.height/2,e=Math.random()<.5?-e:e):e=-t.height+Math.random()*t.height*2,cc.v3(n+this.mainCamera.x,e+this.mainCamera.y)},t.prototype.getTopRandomPos=function(){var e,t,n=this.mainCamera,o=n.width,i=n.height;e=Math.random()*o*.7-.35*o,t=i/2+100;var r=this.mainCamera.convertToWorldSpaceAR(cc.v3(e,t));return u.default.ins.uifight.monsterBox.convertToNodeSpaceAR(r)},r([l([cc.Prefab])],t.prototype,"Demo",void 0),r([f],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./core/LoadRes":"LoadRes","./game/fight/Buff":"Buff","./game/fight/bullet":"bullet","./game/gameManager":"gameManager"}],UIMain:[function(e,t,n){"use strict";cc._RF.push(t,"5d2c52fbVBOCqwEc3aH+InV","UIMain");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./core/LoadRes"),c=e("./game/gameManager"),s=cc._decorator,u=s.ccclass,p=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){var e=this;c.default.ins.uimain=this,c.default.ins.canvas=this.node,a.default.get("Prefabs/toast",cc.Prefab).then(function(e){return c.default.ins.toast=e});var t=0;["Prefabs/view/start","Prefabs/view/popUp","Prefabs/player"].forEach(function(n){t++,a.default.get(n,cc.Prefab).then(function(n){cc.instantiate(n).setParent(c.default.ins.canvas),0==--t&&e.adjustHierarchy(["start","player","popUp"])})})},t.prototype.adjustHierarchy=function(e){var t=this;e.forEach(function(e,n){var o=cc.find(e,t.node);o?o.zIndex=n:cc.warn("\u6ca1\u6709\u5728 UIMain \u8282\u70b9\u4e0b\u627e\u5230 "+e+" \u8282\u70b9")})},r([u],t)}(cc.Component));n.default=p,cc._RF.pop()},{"./core/LoadRes":"LoadRes","./game/gameManager":"gameManager"}],basePop:[function(e,t,n){"use strict";cc._RF.push(t,"dd4de4goRZJA7bBzuTVs7jN","basePop");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprites=[],t}return i(t,e),t.prototype.onLoad=function(){this._init()},t.prototype._init=function(){var e=this;this.events={},this.initEvent(),this._bindEvent(),this.sprites.length>0&&(this.imgs={},this.sprites.forEach(function(t){return e.imgs[t.name]=t})),this.sprites=void 0,this.init()},t.prototype._bindEvent=function(){var e=new cc.Component.EventHandler;e.target=this.node,e.component=this.compName,e.handler="_onClick",this.node.getComponentsInChildren(cc.Button).forEach(function(t){return t.clickEvents.push(e)})},t.prototype.init=function(){},t.prototype._onClick=function(e){if(e.target==e.currentTarget){var t=e.currentTarget.name;this.events[t]?this.events[t](e.currentTarget):cc.warn("No event callback is initialized for the '"+t+"' button")}},t.prototype._onEvent=function(){},t.prototype.initEvent=function(){},r([s([cc.SpriteFrame])],t.prototype,"sprites",void 0),r([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{}],bullet:[function(e,t,n){"use strict";cc._RF.push(t,"fb19ewQGaRKkp6UbFK2poGo","bullet");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../data/dataManager"),c=e("../gameManager"),s=e("./monster"),u=cc._decorator,p=u.ccclass,f=(u.property,Math.PI/180),l=180/Math.PI,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=3.5,t.tweenlock=!1,t}return i(t,e),Object.defineProperty(t.prototype,"inScreen",{get:function(){var e=c.default.fightComp.colorMask,t=this.node.x>e.x-e.width/2&&this.node.x<e.x+e.width/2,n=this.node.y>e.y-e.height/2&&this.node.y<e.y+e.height/2;return t&&n},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.type=this.node.name,this.initScan(),this.initCollision()},t.prototype.start=function(){},t.prototype.update=function(e){c.default.fightComp.over&&this.pet.bulletPool.put(this.node),this.scan[this.type](1e3*e)},t.prototype.computeAngle=function(){var e=this.target.position.sub(this.node.position);return cc.Vec2.UP.signAngle(cc.v2(e.x,e.y))*l},t.prototype.getDistance=function(){var e=c.default.ins.canvas.height/this.speed,t=e*Math.sin(this.angle*f),n=e*Math.cos(this.angle*f);return cc.v3(t,n)},t.prototype.Akt=function(){this.node.angle=0-this.computeAngle(),this.angle=0-this.node.angle,this.comeToTarget()},t.prototype.comeToTarget=function(){var e=this;if(!this.tweenlock){var t=-this.computeAngle(),n=Math.abs(this.angle+t),o=this.getDistance();cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).call(function(){return e.tweenlock=!0}).to(.8*n/360,{angle:t}).call(function(){return e.tweenlock=!1}).by(1,{position:o}).repeatForever().start()}},t.prototype.initScan=function(){var e=this;this.scan={petMax:function(){e.inScreen||e.pet.bulletPool.put(e.node)},petAD:function(){e.inScreen||e.pet.bulletPool.put(e.node)},pet1:function(){e.inScreen||e.pet.bulletPool.put(e.node)},pet2:function(){e.inScreen||e.pet.bulletPool.put(e.node)}}},t.prototype.initCollision=function(){var e=this;this.collision={petMax:function(t){t.node.getComponent(s.default)&&t.node.getComponent(s.default).hurt(a.default.fight.petAkt[e.type])},petAD:function(t){t.node.getComponent(s.default)&&t.node.getComponent(s.default).hurt(a.default.fight.petAkt[e.type])},pet1:function(t){t.node!=e.node&&(t.node.getComponent(s.default).hurt(a.default.fight.petAkt[e.type]),e.pet.bulletPool.put(e.node))},pet2:function(t){t.node.getComponent(s.default)&&t.node.getComponent(s.default).hurt(a.default.fight.petAkt[e.type])}}},t.prototype.onCollisionEnter=function(e,t){this.collision[this.type](e,t)},r([p],t)}(cc.Component);n.default=d,cc._RF.pop()},{"../../data/dataManager":"dataManager","../gameManager":"gameManager","./monster":void 0}],dataManager:[function(e,t,n){"use strict";cc._RF.push(t,"89dcfDitq1GQbURBw0tXx96","dataManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Common"),i=e("../game/gameManager"),r=e("../game/timeManager");window.getGameConf=function(){return a.gameConf},window.getGameMngr=function(){return a},console.log("getGameConf registered with global!"),console.log("getGameMngr registered with global!");var a=function(){function e(){}return Object.defineProperty(e,"fight",{get:function(){return c.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e,"user",{get:function(){return s.instance},enumerable:!1,configurable:!0}),e.saveData=function(){localStorage.setItem("spinMaster-fight",JSON.stringify(this.fight)),localStorage.setItem("spinMaster-user",JSON.stringify(this.user))},e}();n.default=a;var c=function(){function e(){this.currIndex=1;var e=localStorage.getItem("spinMaster-fight");if(e=JSON.parse(e))for(var t in e)this[t]=e[t]}return Object.defineProperty(e,"instance",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resurgenceCount",{get:function(){return a.roundConf.numData[this.currIndex-1].resurgenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundData",{get:function(){this.currIndex-1>=a.roundConf.round.length&&(this.currIndex=a.roundConf.round.length);var e,t=a.roundConf.round[this.currIndex-1],n=JSON.parse(t.\u602a\u7269\u79cd\u7c7b\u533a\u95f4),o=t.\u602a\u7269\u51fa\u73b0\u95f4\u9694\u79d2\u6570,i=JSON.parse(t.\u6bcf\u6ce2\u602a\u7269\u6570\u91cf),r={};e=JSON.parse(t.\u602a\u7269\u91d1\u5e01),n.forEach(function(t,n){return r[t]=e[n]});var c=t.\u5173\u5361\u602a\u7269\u8840\u91cf\u52a0\u6210,s=t.\u901a\u5173\u5956\u52b1,u=t.\u5730\u56fe\u7c7b\u578b;return{monsterType:n,batchInterval:o,batchCount:i,monsterGold:r,healthPow:c,passGold:s,mapType:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outPower",{get:function(){return a.gameConf.outPower},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ADgold",{get:function(){return a.roundConf.numData[this.currIndex-1].ADGold},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ADpower",{get:function(){return a.gameConf.ADpower},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxIndex",{get:function(){return a.roundConf.round.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"petAkt",{get:function(){return Object.assign({},a.gameConf.petAkt[this.currIndex])},enumerable:!1,configurable:!0}),e}(),s=function(){function e(){this._gold=3e4,this._power=2,this._knifeLevel=1,this.heroLevel={1:1,2:1,3:1,4:1,5:1},this.heroType="1",this.petActive={petMax:!1,petAD:!0,pet1:!1,pet2:!0},this.knifeTierActive=1;var e=localStorage.getItem("spinMaster-user");if(e=JSON.parse(e))for(var t in e)this[t]=e[t]}return Object.defineProperty(e,"instance",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gold",{get:function(){return this._gold},set:function(e){this._gold=e||this._gold,this._gold<0&&(this._gold=0),i.default.ins.start&&i.default.ins.start.updateInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"goldStr",{get:function(){return o.formatNum(this.gold)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){return this._power},set:function(e){this._power=e||this._power,this._power<0&&(this._power=0),i.default.ins.start.updateInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerStr",{get:function(){return o.formatNum(this.power)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"earningStr",{get:function(){return o.formatNum(r.default.earningStore)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MaxKnifeLevel",{get:function(){return a.gameConf.knifeConf.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"knifeLevel",{get:function(){return this._knifeLevel},set:function(e){this._knifeLevel=Math.min(e,this.MaxKnifeLevel)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"knifeType",{get:function(){for(var e=0,t=a.gameConf.knifeUnlock;e<t.length;e++){var n=t[e];if(n.unlock>this.knifeLevel)return a.gameConf.knifeUnlock[a.gameConf.knifeUnlock.indexOf(n)-1].type}return a.gameConf.knifeUnlock[a.gameConf.knifeUnlock.length-1].type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"knifeAkt",{get:function(){return a.gameConf.knifeConf[this.knifeLevel-1].akt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextLevelKnifeType",{get:function(){for(var e=0,t=a.gameConf.knifeUnlock;e<t.length;e++){var n=t[e];if(n.unlock>this.knifeLevel+1)return a.gameConf.knifeUnlock[a.gameConf.knifeUnlock.indexOf(n)-1].type}return a.gameConf.knifeUnlock[a.gameConf.knifeUnlock.length-1].type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextKnifeGold",{get:function(){return this.knifeLevel<a.gameConf.knifeConf.length?a.gameConf.knifeConf[this.knifeLevel].gold:a.gameConf.knifeConf[a.gameConf.knifeConf.length-1].gold},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextKnifeAkt",{get:function(){return this.knifeLevel<a.gameConf.knifeConf.length?a.gameConf.knifeConf[this.knifeLevel].akt:a.gameConf.knifeConf[a.gameConf.knifeConf.length-1].akt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MaxHeroLevel",{get:function(){return a.gameConf.heroGold.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currHeroLevel",{get:function(){return this.heroLevel[this.heroType]},set:function(e){this.heroLevel[this.heroType]=Math.min(e,this.MaxHeroLevel)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"assistAtk",{get:function(){return a.gameConf.heroAkt[this.currHeroLevel-1][this.heroType]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upHeroGold",{get:function(){if(this.currHeroLevel<a.gameConf.heroGold.length)return a.gameConf.heroGold[this.currHeroLevel][this.heroType]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextHeroAkt",{get:function(){if(this.currHeroLevel<a.gameConf.heroAkt.length)return a.gameConf.heroAkt[this.currHeroLevel][this.heroType]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextHeroType",{get:function(){for(var e=0,t=a.gameConf.heroUnlock;e<t.length;e++){var n=t[e];if(n.type==this.heroType&&a.gameConf.heroUnlock.indexOf(n)+1<a.gameConf.heroUnlock.length)return a.gameConf.heroUnlock[a.gameConf.heroUnlock.indexOf(n)+1].type}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextHeroUnlock",{get:function(){for(var e=0,t=a.gameConf.heroUnlock;e<t.length;e++){var n=t[e];if(n.type==this.heroType&&a.gameConf.heroUnlock.indexOf(n)+1<a.gameConf.heroUnlock.length)return a.gameConf.heroUnlock[a.gameConf.heroUnlock.indexOf(n)+1].unlock}},enumerable:!1,configurable:!0}),e}();cc._RF.pop()},{"../Common":"Common","../game/gameManager":"gameManager","../game/timeManager":"timeManager"}],fight:[function(e,t,n){"use strict";cc._RF.push(t,"bd4fc8IKjRFcKYGxB8OFdYm","fight");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../data/dataManager"),u=e("../fight/Buff"),p=e("../gameManager"),f=e("../role/Boss"),l=e("../role/Mon"),d=e("../role/Mon"),h=e("../role/Pet"),g=cc._decorator,y=g.ccclass,m=g.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeCount=0,t.batchIndex=0,t.lastBatchTime=0,t}return i(t,e),Object.defineProperty(t.prototype,"allKillMonCount",{get:function(){var e=0;for(var t in this.monDieCount)e+=this.monDieCount[t];return e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){p.default.ins.fight=this,this.init()},t.prototype.update=function(e){if(this.timeCount+=e,p.default.ins.player&&!p.default.ins.fight.isOver&&p.default.ins.player.skill(e),this.roundData&&!this.isOver){var t=this.timeCount-this.lastBatchTime;0==this.batchIndex&&(t-=3);var n=this.roundData.batchInterval<=t&&null!=this.batchIndex,o=0==this.batchIndex&&null!=this.roundData.batchCount[this.batchIndex];(n||o)&&(this.lastBatchTime=this.timeCount,this.letOutMonster(),this.batchIndex++,null==this.roundData.batchCount[this.batchIndex]&&(this.batchIndex=void 0))}},t.prototype.init=function(){this.temp=new b,this.temp.node=this.node,this.mapBG=cc.find("background",this.node),this.door=p.default.ins.uifight.mapBox.getChildByName("door")},t.prototype.run=function(){var e=this;this.isOver=!1,l.default.monPool={},this.monDieCount={},this.timeCount=0,p.default.ins.player.isLife=!0,this.roundData=s.default.fight.roundData,this.resurgenceCount=s.default.fight.resurgenceCount,this.totalMonCount=this.roundData.batchCount.reduce(function(e,t){return t.forEach(function(t){return e+=t}),e},0);var t=p.default.ins.uifight;p.default.ins.uifight.mapBox.removeAllChildren(),this.door.setParent(p.default.ins.uifight.mapBox);var n=t.getMap(p.default.ins.fight.roundData.mapType);n.setParent(p.default.ins.uifight.mapBox),n.setPosition(0,0),n.active=!0,cc.find("background",t.node).color=cc.find("bg",n).color,this.path=[],cc.find("path",n).children.forEach(function(t){return e.path.push(t.position)});var o=cc.find("door",n),i=o.position,r=o.angle;return this.door.setPosition(i),this.door.angle=r,this.outPos=cc.find("playerPos/out",n).position,p.default.ins.uifight.mainCamera.setPosition(0,0),new Promise(function(o){t.open().then(function(){p.default.ins.player.comeIn(cc.find("playerPos/in",n).position).then(function(){e.cameraMove(),o()})})})},t.prototype.cameraMove=function(){var e=p.default.ins.canvas,t=e.width,n=e.height,o=Math.max(t,n)/30,i=this;null==this.pathIndex&&(this.pathIndex=0),i.path[this.pathIndex]&&function e(){var t=i.path[i.pathIndex],n=cc.v2(t).sub(cc.v2(p.default.ins.uifight.mainCamera)).mag();cc.tween(p.default.ins.uifight.mainCamera).to(n/o,{position:t}).call(function(){i.path[++i.pathIndex]&&e()}).start()}()},t.prototype.letOutMonster=function(){var e=this;cc.log(this.batchIndex,this.roundData.batchCount[this.batchIndex]),this.roundData.batchCount[this.batchIndex].forEach(function(t,n){var o=e.roundData.monsterType[n];if(o<=100)for(;t>0;){var i=d.default.get(o);i.setParent(p.default.ins.uifight.monsterBox),""+o=="8"?i.setPosition(p.default.ins.uifight.getTopRandomPos()):i.setPosition(p.default.ins.uifight.getRandomPos()),t--}else new f.default(o,4).node.setPosition(0,500)})},t.prototype.gameOver=function(){var e=this;this.isOver=!0,p.default.ins.collision.enabled=!1,1!==cc.kGetSpeed()&&cc.kSpeed(1),this.fightPause();var t=p.default.ins.player.isLife&&this.allKillMonCount==this.totalMonCount;cc.log(t),t?(console.log("game over win!!!"),this.openTheDoor().then(function(){var t,n=p.default.ins.player.node,o=n.x,i=n.y;t=Math.abs(e.outPos.x-o)<Math.abs(e.outPos.y-i)?cc.v3(e.outPos.x,i):cc.v3(o,e.outPos.y),p.default.ins.player.leave(t,e.outPos).then(function(){p.default.ins.popUp.open("win")})}),s.default.saveData()):this.resurgenceCount>0?(console.log("game over resurgence!!!"),this.resurgenceCount--,p.default.ins.popUp.open("resurgence")):(console.log("game over lose..."),p.default.ins.player.boom(function(){p.default.ins.popUp.open("lose")}),s.default.saveData())},t.prototype.fightPause=function(){(function e(t){return a(this,void 0,void 0,function(){var n;return c(this,function(){return(n=t.getComponent(d.MonComp))?n.pause():t!=p.default.ins.player.node&&(cc.Tween.stopAllByTarget(t),t.children.forEach(function(t){return e(t)})),[2]})})})(this.node)},t.prototype.openTheDoor=function(){var e=this;return new Promise(function(t){e.door.active=!0;var n=cc.find("dragonAnim",e.door).getComponent(dragonBones.ArmatureDisplay);n.on(dragonBones.EventObject.COMPLETE,function(){n.off(dragonBones.EventObject.COMPLETE),t()}),n.playAnimation("newAnimation",1)})},t.prototype.computedGold=function(){var e=0;for(var t in this.monDieCount)e+=this.roundData.monsterGold[t]*this.monDieCount[t],this.monDieCount[t]=0;return this.allKillMonCount==this.totalMonCount&&(e+=this.roundData.passGold),e},r([y],t)}(cc.Component);n.default=v;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mapList=null,t.over=!0,t.videoX=3,t.monDieCount={small:0,big:0,follow:0,plant:0,excite:0,X:0,get count(){var e=0;for(var t in p.default.ins.fight.temp.fightInfo.monsterType)e+=p.default.ins.fight.temp.monDieCount[t];return e}},t.monsterCount=0,t}return i(t,e),t.prototype.onLoad=function(){p.default.ins.fight.temp=this,this.bg=cc.find("BG",this.node),this.colorMask=cc.find("colorMask",this.bg),cc.find("wall",this.colorMask).children.forEach(function(e){e.width,e.height})},t.prototype.update=function(){},t.prototype.initFight=function(){this.over=!1,this.map=cc.instantiate(cc.find(""+s.default.fight.roundData.mapType,this.mapList.data)),this.map.setParent(this.bg),this.map.setPosition(0,0),this.map.active=!0,this.resurgenceCount=s.default.fight.resurgenceCount,this.videoX=3},t.prototype.fightPause=function(){(function e(t){return a(this,void 0,void 0,function(){var n;return c(this,function(){return(n=t.getComponent(d.MonComp))?n.pause():t!=p.default.ins.player.node&&(cc.Tween.stopAllByTarget(t),t.children.forEach(function(t){return e(t)})),[2]})})})(this.node)},t.prototype.fightResume=function(){(function e(t){return a(this,void 0,void 0,function(){var n;return c(this,function(){return(n=t.getComponent(d.MonComp))?n.resume():t.getComponent(h.default)?(t.getComponent(h.default).run(),t.getComponent(h.default).knifeZhuanZhuanZhuan()):t!=p.default.ins.player.node&&t.children.forEach(function(t){return e(t)}),[2]})})})(this.node)},t.prototype.petEnter=function(){var e=this,t=new Array,n=p.default.ins.canvas;for(var o in s.default.user.petActive)s.default.user.petActive[o]&&t.push(p.default.ins.getPet(o));if(!(t.length<=0)){var i=n.width/(t.length+1);t.forEach(function(t,o){t.active=!0;var r=(o+1)*i-n.width/2,a=-n.height/2-200;t.setPosition(r,a),t.setParent(e.bg),cc.tween(t).to(1,{y:.2*-n.height}).call(function(){t.getComponent(h.default).ready=!0,t.getComponent(h.default).run(),t.getComponent(h.default).knifeZhuanZhuanZhuan()}).start()})}},t.prototype.clearMap=function(){for(var e in this.mapMovePointIndex=0,this.map.removeFromParent(),this.map.destroy(),this.map=void 0,this.bg.setPosition(0,0),this.colorMask.setPosition(0,0),this.clearRoot(),this.clearBG(),this.monsterCount=0,this.fightInfo.monsterType)this.monDieCount[e]=0;this.resurgenceCount=s.default.fight.resurgenceCount,p.default.ins.recyclePets()},t.prototype.clearRoot=function(){this.node.getComponentsInChildren(d.MonComp).forEach(function(e){return d.default.recycle(e)}),this.node.getComponentsInChildren(u.default).forEach(function(e){return p.default.ins.recycleBuff(e)})},t.prototype.clearBG=function(){this.node.getComponentsInChildren(d.MonComp).forEach(function(e){return d.default.recycle(e)}),this.node.getComponentsInChildren(u.default).forEach(function(e){return p.default.ins.recycleBuff(e)})},t.prototype.gameOver=function(e){var t=this;cc.director.getCollisionManager().enabled=!1,this.over=!0,1!==cc.kGetSpeed()&&cc.kSpeed(1),this.fightPause(),e?(console.log("game over win!!!"),this.openTheDoor(function(){p.default.ins.player.leave().then(function(){p.default.ins.popUp.open("win",[cc.find("X",p.default.ins.fight.temp.node)])})}),s.default.saveData()):this.resurgenceCount>0?(console.log("game over resurgence!!!"),this.resurgenceCount--,p.default.ins.popUp.open("resurgence")):(console.log("game over lose..."),p.default.ins.player.boom(function(){t.clearMap(),p.default.ins.popUp.open("lose")}),s.default.saveData())},t.prototype.computedGold=function(){var e=0;for(var t in this.fightInfo.monsterType)e+=s.default.fight.monsterGold[t]*this.monDieCount[t],this.monDieCount[t]=0;return this.monsterCount=0,e},t.prototype.resurgence=function(){cc.director.getCollisionManager().enabled=!0,this.over=!1,this.fightResume(),p.default.ins.player.resurgence()},t.prototype.getRandomMonster=function(){if(!(this.monsterCount-this.monDieCount.count<=0)){var e=new Array;return this.bg.children.forEach(function(t){t.getComponent(d.MonComp)&&e.push(t)}),e[Math.floor(Math.random()*e.length)]}},t.prototype.openTheDoor=function(e){this.door.active=!0;var t=cc.find("dragonAnim",this.door).getComponent(dragonBones.ArmatureDisplay);t.on(dragonBones.EventObject.COMPLETE,function(){e&&e(),t.off(dragonBones.EventObject.COMPLETE)}),t.playAnimation("newAnimation",1)},r([m(cc.Prefab)],t.prototype,"mapList",void 0),t}(cc.Component);cc._RF.pop()},{"../../data/dataManager":"dataManager","../fight/Buff":"Buff","../gameManager":"gameManager","../role/Boss":"Boss","../role/Mon":"Mon","../role/Pet":"Pet"}],gameManager:[function(e,t,n){"use strict";cc._RF.push(t,"0a50exLwgNM+ZXCh/bMaIct","gameManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./role/Pet"),i=e("./fight/Buff"),r=e("./timeManager"),a=e("../data/dataManager"),c=function(){function e(){this.toastNodePool=new cc.NodePool,this.pets={petMax:void 0,petAD:void 0,pet1:void 0,pet2:void 0},this.buffs={excite:new cc.NodePool(i.default),X:new cc.NodePool(i.default)}}return Object.defineProperty(e,"ins",{get:function(){return null==e._ins&&(e._ins=new e),e._ins},enumerable:!1,configurable:!0}),e.clearIns=function(){e._ins=void 0,r.default.stop(),r.default.clearTimer()},Object.defineProperty(e.prototype,"collision",{get:function(){return cc.director.getCollisionManager()},enumerable:!1,configurable:!0}),e.prototype.sendToast=function(t){var n,o=this;return n=this.toastNodePool.size()>0?this.toastNodePool.get():cc.instantiate(this.toast),cc.find("text",n).getComponent(cc.Label).string=t,n.setParent(e.ins.canvas.getComponentInChildren(cc.Camera).node),n.scale=0,n.setPosition(0,-250),n.opacity=0,n.zIndex=99,new Promise(function(e){cc.tween(n).to(.2,{scale:1,y:0,opacity:255}).delay(.8).to(.2,{scale:0,y:250,opacity:0}).call(function(){o.toastNodePool.put(n),e(0)}).start()})},e.prototype.getPet=function(e){return this.pets[e]||(this.pets[e]=this.uifight.getPet(e)),this.pets[e]},e.prototype.recyclePets=function(){for(var e in this.pets)if(this.pets[e]){var t=this.pets[e];t.removeFromParent(),t.setPosition(0,0),t.getComponent(o.default).ready=!1}},e.prototype.getBuff=function(e){var t;return this.buffs[e].size()>0?this.buffs[e].get():t=this.uifight.getBuff(e),t},e.prototype.recycleBuff=function(e){this.buffs[e.type].put(e.node)},e.prototype.setKnifeTier=function(e){a.default.user.knifeTierActive=e,a.default.saveData()},e}();n.default=c,window.GMG=c,console.log("GMG added with window"),cc._RF.pop()},{"../data/dataManager":"dataManager","./fight/Buff":"Buff","./role/Pet":"Pet","./timeManager":"timeManager"}],knife:[function(e,t,n){"use strict";cc._RF.push(t,"adaf6gwszBCdLPciR5PJMVb","knife");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../data/dataManager"),c=e("../gameManager"),s=e("../role/Boss"),u=e("../role/Mon"),p=cc._decorator,f=p.ccclass,l=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return i(t,e),n=t,Object.defineProperty(t,"akt",{get:function(){null==this.knifeAkt&&(this.knifeAkt=a.default.user.knifeAkt),null==this.heroAkt&&(this.heroAkt=a.default.user.assistAtk);var e=a.default.user.knifeTierActive*c.default.ins.player.knifeCount;return Math.round(this.heroAkt/e)+this.knifeAkt},enumerable:!1,configurable:!0}),t.prototype.onCollisionEnter=function(e,t){n.callGroup("enter",e,t)},t.prototype.onCollisionExit=function(e,t){n.callGroup("exit",e,t)},t.callGroup=function(e,t,o){var i=n[e+"_"+t.node.group];i?i(t,o):cc.warn(o.node.group+" \u4e0e "+t.node.group+" "+{enter:"\u53d1\u751f\u78b0\u649e",stay:"\u6301\u7eed\u78b0\u649e",exit:"\u78b0\u649e\u7ed3\u675f"}[e]+" \u4f46\u5e76\u672a\u5728 "+o.node.group+" \u8fdb\u884c\u5904\u7406\u2026\u2026")},t.enter_monster=function(e){if(0==e.tag){var t=e.node.getComponent(u.MonComp);t&&t.hurt(n.akt)}},t.enter_boss=function(e){var t=e.node.getComponent(s.bossBox);t&&t.hurt(n.akt);var o=50*Math.random()+150;if(t.hp){t.node.color=cc.color(o,o,o);var i=s.BossComp.ins;e.node.getChildByName("hurtSpine")||(i.hurtSpine.node.setParent(e.node),i.hurtSpine.node.setPosition(0,0)),i.hurtSpine.node.active=!0,i.hurtSpine.setAnimation(0,"jiZhong-huang",!1)}},t.exit_boss=function(e){var t=e.node.getComponent(s.bossBox);t.hp&&(t.node.color=cc.color(255,255,255))},n=r([f],t)}(cc.Component));n.default=l,cc._RF.pop()},{"../../data/dataManager":"dataManager","../gameManager":"gameManager","../role/Boss":"Boss","../role/Mon":"Mon"}],monster:[function(e,t,n){"use strict";cc._RF.push(t,"08ca8U5rhtJMYaXMcibfjx7","monster");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Common"),c=e("../../data/dataManager"),s=e("../gameManager"),u=Math.PI/180,p=180/Math.PI,f={1:"xg1-",2:"xg2-",3:"xg3-",4:"xg4-"},l=cc._decorator,d=l.ccclass,h=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=5,t._isLife=!0,t.health=0,t.other=["excite","X"],t}return i(t,e),Object.defineProperty(t.prototype,"inScreen",{get:function(){var e=s.default.ins.uifight.mainCamera,t=this.node.x>e.x-e.width/2&&this.node.x<e.x+e.width/2,n=this.node.y>e.y-e.height/2&&this.node.y<e.y+e.height/2;return t&&n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slowSpeed",{get:function(){return 4*this.speed},enumerable:!1,configurable:!0}),t.prototype.update=function(e){var t=Math.round(1e3*e);this.detection(t),this.hurtAnimTime?this.hurtAnimTime=this.hurtAnimTime-t<=0?void 0:this.hurtAnimTime-t:this.inHurt&&(this.inHurt=!1,this.run())},t.prototype.detection=function(e){this.dtctT<=0&&!this.inScreen?this.findPlayer():this.dtctT-=e},t.prototype.init=function(){this.type=this.node.name,this.health=s.default.ins.fight.roundData.healthPow*c.default.gameConf.monster_hp[this.type],this.health=Math.round(this.health),this.changeSkin(),cc.find("health",this.node).getComponent(cc.Label).string=""+a.formatNum(this.health),this._isLife=!0;var e=s.default.ins.uifight.mainCamera,t=Math.random()*e.width-e.width/2,n=Math.random()*e.height-e.height/2;this.moveTo(cc.v3(t+e.x,n+e.y))},t.prototype.moveTo=function(e){this.angle=this.computeAngle(e),this._currTween=this.run(),this.dtctT=1e3*this.speed},t.prototype.computeAngle=function(e){var t=e.sub(this.node.position);return cc.Vec2.UP.signAngle(cc.v2(t.x,t.y))*p},t.prototype.getDistance=function(){var e=s.default.ins.canvas.height/this.speed,t=e*Math.sin(this.angle*u),n=e*Math.cos(this.angle*u);return cc.v3(-t,n)},t.prototype.run=function(){var e=this.getDistance(),t=this.angle-this.node.angle;return Math.abs(t)>180&&(t>0?t-=360:t+=360),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).by(.85/360*Math.abs(t),{angle:t}).by(1,{position:e}).repeatForever().start()},t.prototype.getSlowDistance=function(){var e=s.default.ins.canvas.height/this.slowSpeed,t=e*Math.sin(this.angle*u),n=e*Math.cos(this.angle*u);return cc.v3(-t,n)},t.prototype.runSlow=function(){var e=this.getSlowDistance(),t=this.angle-this.node.angle;return Math.abs(t)>180&&(t>0?t-=360:t+=360),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).by(.85/360*Math.abs(t),{angle:t}).by(1,{position:e}).repeatForever().start()},t.prototype.pause=function(){cc.Tween.stopAllByTarget(this.node)},t.prototype.resume=function(){cc.tween(this.node).then(this._currTween).start()},t.prototype.die=function(){this._isLife=!1,cc.Tween.stopAllByTarget(this.node);var e=cc.find("0602",this.node);e.active=!1,e.children.forEach(function(e){var t=e.getComponent(cc.ParticleSystem);t&&t.resetSystem()});var t=cc.find("ci",e).getComponent(cc.Animation);t.on(cc.Animation.EventType.FINISHED,function(){s.default.ins.uifight&&t.off(cc.Animation.EventType.FINISHED)}),e.active=!0,t.play("0601"),this.node.getComponent(cc.Sprite).enabled=!1,cc.find("health",this.node).active=!1,this.diedCall()},t.prototype.diedCall=function(){var e=s.default.ins.fight;e.monDieCount[this.type]?e.monDieCount[this.type]++:e.monDieCount[this.type]=1,s.default.ins.uifight.setProgress(e.allKillMonCount/e.totalMonCount),e.allKillMonCount==e.totalMonCount&&e.gameOver()},t.prototype.hurt=function(e){if(this.health-e<=0)this.die();else{if(this.health-=e,cc.find("health",this.node).getComponent(cc.Label).string=""+a.formatNum(this.health),this.changeSkin(),this.hurtAnimTime=400,this.inHurt)return;this.hurtAnim(),this.runSlow(),this.inHurt=!0}},t.prototype.changeSkin=function(){var e=parseInt(this.type)%4;if(0==e&&(e=4),-1==this.other.indexOf(""+e)){var t=Math.floor(this.health/c.default.user.knifeAkt/2);t>5?t=5:t<1&&(t=1);var n=""+f[e]+t;if(this.node.getComponent(cc.Sprite).spriteFrame.name!=n){var o=this.node,i=o.width,r=o.height;this.node.getComponent(cc.Sprite).spriteFrame=cc.resources.get("Texture/role/monster/"+n,cc.SpriteFrame),this.node.width=i,this.node.height=r}}},t.prototype.hurtAnim=function(){var e=this,t=this.node.getComponent(cc.Animation),n=t.getAnimationState("monsterHurt").isPlaying;t.on("finished",function(){e.hurtAnimTime&&t.play("monsterHurt")}),!n&&this.hurtAnimTime&&t.play("monsterHurt")},t.prototype.onCollisionEnter=function(e){"wall"==e.node.group&&this.findPlayer()},t.prototype.findPlayer=function(){var e=s.default.ins.player.node.parent.convertToWorldSpaceAR(s.default.ins.player.node.position),t=s.default.ins.fight.node.convertToNodeSpaceAR(e);this.moveTo(t)},t.prototype.reuse=function(){this.node.active=!0},t.prototype.unuse=function(){this._currTween=void 0,cc.Tween.stopAllByTarget(this.node),this.node.active=!1,this.node.getComponent(cc.Sprite).enabled=!0,cc.find("health",this.node).active=!0,this.hurtAnimTime=void 0,this.node.getComponent(cc.Animation).stop("monsterHurt"),this.node.scale=1},r([d],t)}(cc.Component));n.default=h,cc._RF.pop()},{"../../Common":"Common","../../data/dataManager":"dataManager","../gameManager":"gameManager"}],player:[function(e,t,n){"use strict";cc._RF.push(t,"67718ERK4BDhL3SySUx2ujL","player");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../data/dataManager"),u=e("../fight/knife"),p=e("../gameManager"),f=Math.PI/180,l=(Math.PI,cc._decorator),d=l.ccclass,h=l.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.body=null,t.heroList=null,t.knifeList=null,t.rotateSpeed=1.2,t.minR=100,t._exciteTime=8e3,t._exciteSpeedX=3.5,t}return i(t,e),Object.defineProperty(t.prototype,"knifeModule",{get:function(){return null==this._km&&(this._km=cc.instantiate(this.knifeList.data.getChildByName(""+s.default.user.knifeType))),this._km.name!=s.default.user.knifeType&&(this._km=cc.instantiate(this.knifeList.data.getChildByName(""+s.default.user.knifeType))),this._km},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){var e=p.default.ins.canvas,t=e.width,n=e.height;return Math.max(t,n)/.8*1.5},enumerable:!1,configurable:!0}),t.prototype.test=function(){var e=this,t=[];["leave","comeIn","addKnife"].forEach(function(n){window[n+"Player"]=e[n].bind(e),t.push(n+"Player")}),window.effectTest=this.effectAnim.bind(this),window.boomboom=this.boom.bind(this),console.log('add "%c'+t+'%c" to window from Player...',"color: rgba(0,100,255,1); font-weight: bolder","")},t.prototype.onLoad=function(){p.default.ins.player=this},t.prototype.start=function(){this.init(),this.test()},t.prototype.update=function(){},t.prototype.init=function(){var e=this,t=cc.find(""+s.default.user.heroType,this.heroList.data),n=cc.find("knifeWraper",this.body);this.body.removeAllChildren(),n.setParent(this.body),t.children.forEach(function(t){return cc.instantiate(t).setParent(e.body)}),cc.find("assist",this.body).scale=0,this.center=this.node.position,this.node.active=!1,this.skill=y.ins.init()},t.prototype.heroDuangDuangDuang=function(){cc.tween(cc.find("hero",this.body)).repeatForever(cc.tween().to(.25,{scaleX:.97,scaleY:1.03}).to(.25,{scaleX:1,scaleY:1}).to(.25,{scaleX:1.03,scaleY:.97}).to(.25,{scaleX:1,scaleY:1})).start()},t.prototype.startRotate=function(e){var t=this;void 0===e&&(e=this.rotateSpeed);var n=cc.tween().by(this.rotateSpeed,{angle:-360}).call(function(e){e.angle=0}),o=cc.tween().repeatForever(n),i=["assist/arm"];this.knifeModule.children.forEach(function(e){return i.push("knifeWraper/"+e.name+"/knifes")}),i.forEach(function(e){return o.clone(cc.find(e,t.body)).start()})},t.prototype.computeInfo=function(){var e=cc.find("assist/arm",this.body),t=e.width,n=e.height,o=Math.max(t/2,n/2),i=cc.find("tier1",this.knifeModule),r=360/this.knifeCount,a=i.width/2/Math.tan(r/2*f);this.tier1R=Math.max(Math.round(a),this.minR,o);var c=cc.find("tier2",this.knifeModule),s=cc.find("tier3",this.knifeModule);return c&&(this.tier2R=this.tier1R+Math.max(.65*i.height,.65*c.height)),s&&(this.tier3R=this.tier2R+Math.max(.65*c.height,.65*s.height)),r},t.prototype.setKnifeR=function(e,t){return a(this,void 0,void 0,function(){var n=this;return c(this,function(){return[2,new Promise(function(o){cc.tween(e).to(n.rotateSpeed/2,{anchorY:.5-t/e.height}).call(function(e){e.addComponent(cc.BoxCollider);var t=e.getComponent(cc.BoxCollider);t.offset=cc.v2(e.width*(e.anchorX-.5),e.height*(e.anchorY-.5)),t.size=cc.size(e.width,e.height),o("Radius set successfully!")}).start()})]})})},t.prototype.refreshKnifeFace=function(){var e=this.knifeCount;this.clearAllKnife(),this.addKnife(e)},t.prototype.changeHeroFace=function(e){var t=this,n=cc.find(e,this.heroList.data),o=cc.find("knifeWraper",this.body);this.body.removeAllChildren(),o.setParent(this.body),n.children.forEach(function(e){return cc.instantiate(e).setParent(t.body)}),this.startRotate();var i=cc.find("assist",this.body);i.scale=0,cc.tween(i).to(this.rotateSpeed/2,{scaleX:-1,scaleY:1}).start(),this.refreshKnifeFace(),this.skill=y.ins.init(),this.heroDuangDuangDuang()},t.prototype.addKnife=function(e){var t=this,n=cc.find("knifeWraper/tier1/knifes",this.body),o=0;e=Math.round(e),this.knifeCount=n.childrenCount+e;for(var i=this.computeInfo(),r=function(){var r=-i*(a.knifeCount-o-1),c=n.children[o];c||(e--,(c=cc.instantiate(cc.find("tier1",a.knifeModule))).addComponent(u.default),c.group="knife",c.angle=0,c.setParent(n),c.setPosition(0,0)),a.setKnifeR(c,a.tier1R),cc.tween(c).to(Math.abs(r-c.angle)*a.rotateSpeed/360,{angle:r}).start(),[2,3].forEach(function(e){var n=cc.find("knifeWraper/tier"+e,t.body);if(e>s.default.user.knifeTierActive)n.active=!1;else{n.active=!0;var i=cc.find("knifes",n),a=i.children[o];a||((a=cc.instantiate(cc.find("tier"+e,t.knifeModule))).setParent(i),a.setPosition(0,0),a.addComponent(u.default),a.group="knife",a.angle=0),t.setKnifeR(a,t["tier"+e+"R"]),cc.tween(a).to(Math.abs(r-a.angle)*t.rotateSpeed/360,{angle:r}).start()}}),o++},a=this;e>0;)r()},t.prototype.clearAllKnife=function(){var e=this;[1,2,3].forEach(function(t){t<=s.default.user.knifeTierActive&&cc.find("knifeWraper/tier"+t+"/knifes",e.body).removeAllChildren()}),this.knifeCount=0},t.prototype.to=function(e){var t=this;void 0===e&&(e=this.center);var n=cc.v2(e).sub(cc.v2(this.node)).mag(),o=p.default.ins.canvas,i=o.width,r=o.height,a=Math.max(i,r)/.6;return new Promise(function(o){cc.tween(t.node).to(n/a,{position:e}).call(function(){return o(void 0)}).start()})},t.prototype.takeBackAllKnife=function(){var e=this;return new Promise(function(t){cc.tween(cc.find("assist",e.body)).to(.8,{scale:0}).start();var n=0;[1,2,3].forEach(function(o){o>s.default.user.knifeTierActive||cc.find("knifeWraper/tier"+o+"/knifes",e.body).children.forEach(function(o){n++,e.setKnifeR(o,0).then(function(){0==--n&&t("take over!")})})})})},t.prototype.leave=function(e,t){var n=this,o=e.sub(this.node.position).mag();return new Promise(function(i){return cc.tween(n.node).to(o/n.speed,{position:e}).call(function(){n.takeBackAllKnife().then(function(){o=t.sub(e).mag(),cc.tween(n.node).to(o/n.speed/1.5,{position:t}).call(function(){return i()}).start()})}).start()})},t.prototype.comeIn=function(e,t){var n=this;void 0===t&&(t=this.center);var o=t.sub(e).mag();return this.node.active=!0,this.node.position=e,this.heroDuangDuangDuang(),this.startRotate(),new Promise(function(e){return cc.tween(n.node).to(o/n.speed,{position:t}).delay(.15).call(function(){n.body.children.forEach(function(e){return e.active=!0}),cc.tween(cc.find("assist",n.body)).to(n.rotateSpeed/2,{scaleX:-1,scaleY:1}).start(),n.addKnife(6),e()}).start()})},t.prototype.die=function(){p.default.ins.sendToast("\u78b0\u5230\u5c0f\u602a\u4e86\uff01\uff01\uff01")},t.prototype.exciting=function(){var e=this;this.startRotate(this.rotateSpeed/this._exciteSpeedX);var t=cc.find("effect/03",this.node);t.active=!0;var n=t.children[0].getComponent(cc.Animation);n.play(n.getClips()[0].name);var o=setInterval(function(){var i=100*cc.kGetSpeed();e._exciteTime-=i,e._exciteTime<=0&&(e.startRotate(e.rotateSpeed*e._exciteSpeedX),n.stop(),t.active=!1,clearInterval(o),e._exciteTime=8e3)},100)},t.prototype.boom=function(e){var t=this,n=this;cc.tween(cc.find("assist",this.body)).to(.8,{scale:0}).start();var o=0;[1,2,3].forEach(function(i){var r=cc.find("knifeWraper/tier"+i,t.body);r.active&&cc.find("knifes",r).children.forEach(function(i){o++,t.setKnifeR(i,0).then(function(){0==--o&&cc.tween(n.node).to(.3,{scale:1.2}).call(function(){n.body.active=!1,n.node.scale=1,n.effectAnim(function(){n.body.active=!0,n.node.setPosition(0,800/1334*p.default.ins.canvas.height),e&&e()})}).start()})})})},t.prototype.effectAnim=function(e){var t=cc.find("effect/0601",this.node),n=cc.find("ci",t).getComponent(cc.Animation);t.children.forEach(function(e){var t=e.getComponent(cc.ParticleSystem);t&&t.resetSystem()}),n.on(cc.Animation.EventType.FINISHED,function(){setTimeout(function(){e&&e(),n.off(cc.Animation.EventType.FINISHED)},800)}),t.active=!0,n.play("effect/0601")},t.prototype.resurgence=function(){var e=this;p.default.ins.fight.temp.over||(this.isLife=!1,setTimeout(function(){e.isLife=!0},1e3))},r([h(cc.Node)],t.prototype,"body",void 0),r([h(cc.Prefab)],t.prototype,"heroList",void 0),r([h(cc.Prefab)],t.prototype,"knifeList",void 0),r([d],t)}(cc.Component);n.default=g;var y=function(){function e(){this.running={1:function(){},2:function(){var e=cc.color(255,49,12),t=cc.find("HUOYAN",p.default.ins.player.body).getComponent(sp.Skeleton);t.node.active=!0;var n=t.setAnimation(0,"HUOYAN",!1);t.setCompleteListener(function(e){cc.log("setCompleteListener",e)}),t.setTrackCompleteListener(n,function(e){cc.log("setTrackCompleteListener",e)}),t.setTrackEndListener(n,function(e){cc.log("setTrackEndListener",e)}),[1,2,3].forEach(function(t){t>s.default.user.knifeTierActive||cc.find("knifeWraper/tier"+t+"/knifes",p.default.ins.player.body).children.forEach(function(t){return t.color=e})})},3:function(){},4:function(){cc.find("assist/arm",p.default.ins.player.body).children.forEach(function(e){cc.tween(cc.find("item",e)).to(.5,{height:250,width:60}).start()})},5:function(){var e=cc.find("BAOHUZHAO",p.default.ins.player.body).getComponent(sp.Skeleton);e.node.active=!0,e.setAnimation(0,"shencheng",!1),e.addAnimation(0,"baohu",!0)}},this.stopping={1:function(){},2:function(){var e=cc.color(255,255,255);[1,2,3].forEach(function(t){t>s.default.user.knifeTierActive||cc.find("knifeWraper/tier"+t+"/knifes",p.default.ins.player.body).children.forEach(function(t){return t.color=e})})},3:function(){},4:function(){cc.find("assist/arm",p.default.ins.player.body).children.forEach(function(e){cc.tween(cc.find("item",e)).to(.5,{height:100,width:30}).start()})},5:function(){cc.find("BAOHUZHAO",p.default.ins.player.body).getComponent(sp.Skeleton).setAnimation(0,"xiaoshi",!1)}},this.time={count:0,get T(){return e.ins.interval+e.ins.duration},get margin(){return this.count%this.T}}}return Object.defineProperty(e,"ins",{get:function(){return e._ins||(e._ins=new e),e._ins},enumerable:!1,configurable:!0}),e.prototype.init=function(){switch(this.time.count=0,this.active=!1,s.default.user.heroType){case"1":this.interval=0,this.duration=0;break;case"2":this.interval=5,this.duration=5;break;case"3":this.interval=0,this.duration=0;break;case"4":this.interval=8,this.duration=5;break;case"5":this.interval=10,this.duration=10,cc.find("BAOHUZHAO",p.default.ins.player.body).getComponent(sp.Skeleton).setAnimation(0,"xiaoshi",!1)}return e.ins.count.bind(this)},e.prototype.count=function(e){this.time.count+=e,this.time.margin<this.interval&&this.active?(this.active=!1,cc.log("\u82f1\u96c4"+s.default.user.heroType+", \u6280\u80fd\u51b7\u5374\u4e2d"),this.stopping[s.default.user.heroType]()):this.time.margin>=this.interval&&this.time.margin<this.time.T&&!this.active&&(this.active=!0,cc.log("\u82f1\u96c4"+s.default.user.heroType+", \u6280\u80fd\u5df2\u6fc0\u6d3b"),this.running[s.default.user.heroType]())},e}();cc._RF.pop()},{"../../data/dataManager":"dataManager","../fight/knife":"knife","../gameManager":"gameManager"}],popEarning:[function(e,t,n){"use strict";cc._RF.push(t,"af90depFs5HWouiTZQc57Hc","popEarning");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../core/API"),s=e("../../gameManager"),u=e("../../timeManager"),p=e("./basePop"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){s.default.ins.uimain.adjustHierarchy(["start","player","popUp"]),cc.find("count",this.node).getComponent(cc.Label).string=a.formatNum(u.default.earningStore),cc.find("video",this.node).active=u.default.earningStoreFull,cc.find("receive",this.node).active=!u.default.earningStoreFull},t.prototype.initEvent=function(){this.compName="popEarning",this.events={video:function(){s.default.ins.popUp.close(),c.default.fullAD({succes:function(){u.default.receiveEarningGold()}})},receive:function(){s.default.ins.popUp.close(),u.default.receiveEarningGold()}}},r([l],t)}(p.default));n.default=d,cc._RF.pop()},{"../../../Common":"Common","../../../core/API":"API","../../gameManager":"gameManager","../../timeManager":"timeManager","./basePop":"basePop"}],popGift:[function(e,t,n){"use strict";cc._RF.push(t,"400aa9cQpNMY5JoHV8FQq2U","popGift");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../gameManager"),c=e("./basePop"),s=cc._decorator,u=s.ccclass,p=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){a.default.ins.player.node.zIndex=-1},t.prototype.initEvent=function(){this.compName="popGift";var e=this;this.events={day:function(t){var n=parseInt(t.parent.name);cc.find("right/getGift/day",a.default.ins.start.node).getComponent(cc.Label).string=n<7?""+(7-n):"7",console.log("\u9886\u53d6\u7b2c"+n+"\u5929\u5956\u52b1"),cc.find("mask",t).active=!0;var o=n+1;o>7&&(e.node.children.forEach(function(e){var t=cc.find("day",e);cc.find("mask",t).active=!0}),o%=7);var i=cc.find(o+"/day",e.node);cc.find("mask",i).active=!1}}},r([u],t)}(c.default));n.default=p,cc._RF.pop()},{"../../gameManager":"gameManager","./basePop":"basePop"}],popGold:[function(e,t,n){"use strict";cc._RF.push(t,"a1d7bee5ddCBoCUxyItduxG","popGold");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../core/API"),s=e("../../../data/dataManager"),u=e("../../gameManager"),p=e("./basePop"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){u.default.ins.uimain.adjustHierarchy(["start","player","popUp"]),cc.find("count",this.node).getComponent(cc.Label).string=a.formatNum(s.default.fight.ADgold)},t.prototype.initEvent=function(){this.compName="popGold",this.events={video:function(){c.default.fullAD({succes:function(){s.default.user.gold+=s.default.fight.ADgold}}),u.default.ins.popUp.close()}}},r([l],t)}(p.default));n.default=d,cc._RF.pop()},{"../../../Common":"Common","../../../core/API":"API","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popLose:[function(e,t,n){"use strict";cc._RF.push(t,"8ceacVd58ZP/5DTYjKaas+r","popLose");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../core/API"),s=e("../../../data/dataManager"),u=e("../../gameManager"),p=e("./basePop"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){u.default.ins.popUp.closeBtn.active=!1,u.default.ins.popUp.computedGold=u.default.ins.fight.computedGold(),cc.find("content/count",this.node).getComponent(cc.Label).string=""+a.formatNum(u.default.ins.popUp.computedGold)},t.prototype.initEvent=function(){this.compName="popLose",this.events={collect:function(){s.default.user.gold+=u.default.ins.popUp.computedGold,u.default.ins.popUp.close(),u.default.ins.fight.close({cbk:function(){u.default.open("start").playerDo("comeIn")}})},extra:function(){c.default.extra({succes:function(){console.log("\u5145\u503c\u6210\u529f\uff01\uff01\uff01"),u.default.ins.popUp.close()},fail:function(){console.log("\u5145\u503c\u5931\u8d25..."),u.default.ins.popUp.close()}})}}},r([l],t)}(p.default));n.default=d,cc._RF.pop()},{"../../../Common":"Common","../../../core/API":"API","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popMap:[function(e,t,n){"use strict";cc._RF.push(t,"3f4e9V17u1ObpjCX4iC/afB","popMap");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../data/dataManager"),c=e("../../gameManager"),s=e("./basePop"),u=cc._decorator,p=u.ccclass,f=u.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroller=null,t.direction="x",t}return i(t,e),t.prototype.onEnable=function(){},t.prototype.initEvent=function(){this.compName="popMap",this.events={round:function(e){var t=parseInt(cc.find("index",e).getComponent(cc.Label).string);c.default.ins.sendToast(""+t)}}},t.prototype.init=function(){var e=this;this.content=cc.find("content",this.scroller);var t=Math.ceil(a.default.fight.maxIndex/15);t=a.default.fight.maxIndex%15==0?t+1:t,this.content.width=t*(cc.find("pages/page",this.content).width-12),cc.find("pages",this.content).children.forEach(function(t){return e.formateNode(t)})},t.prototype.onScoller=function(e){this.contentX||(this.contentX=e.content.x);var t=e.content.x-this.contentX;t=0==t?0:t>0?1:-1,this.contentX=e.content.x,this.contentMove(t)},t.prototype.contentMove=function(e){var t=this.direction,n={x:"width",y:"height"},o=cc.find("pages",this.content).children,i=this.getAgo(o,e);if(this.outScreen(i)&&0!=e){if(this.getPageIndex(this.getNext(o,e))<=1)return;i[t]=this.getNext(o,e)[t]-(i[n[t]]-12)*e,this.formateNode(i)}var r=cc.find("borders",this.content).children,a=this.getAgo(r,e);this.outScreen(a)&&0!=e&&(a[t]=this.getNext(r,e)[t]-a[n[t]]*e),this.getAgo(o,e).zIndex=e>0?-1:1,this.getCurr(o).zIndex=0,this.getNext(o,e).zIndex=e>0?1:-1},t.prototype.getAgo=function(e,t){var n,o=this.direction;return e.forEach(function(e){n=n?n[o]*t<=e[o]*t?e:n:e}),n},t.prototype.getNext=function(e,t){var n,o=this.direction;return e.forEach(function(e){n=n?n[o]*t>e[o]*t?e:n:e}),n},t.prototype.getCurr=function(e){var t,n=this,o=this.direction;return e.forEach(function(e){Math.abs(e[o]+n.content[o])<e.width/2&&(t=e)}),t},t.prototype.outScreen=function(e){var t=this.direction,n={x:"width",y:"height"},o=e[t]+this.content[t];return Math.abs(o)>(this.scroller[n[t]]+e[n[t]])/2},t.prototype.getPageIndex=function(e){var t=this.direction,n={x:"width",y:"height"};return Math.round((e[t]+e[n[t]]/2-12)/(e[n[t]]-24))},t.prototype.formateNode=function(e){var t=this,n=this.getPageIndex(e);e.children.forEach(function(e,o){var i=o+1+15*(n-1);if(i==a.default.fight.maxIndex+1)e.active=!0,e.children.forEach(function(e){return e.active="bg"==e.name});else if(i>a.default.fight.maxIndex)e.active=!1;else{var r=cc.find("line",e),c=cc.find("bg",e),s=(cc.find("img",e),cc.find("index",e));e.active=!0;var u=void 0,p=void 0;i>a.default.fight.currIndex?(u="next",p="lineUnpass"):i==a.default.fight.currIndex?(u="pass",p="lineUnpass"):(u="pass",p="linePass");var f=c.width,l=c.height;c.getComponent(cc.Sprite).spriteFrame=t.imgs[u],c.width=f,c.height=l,c.active=!0,f=r.width,l=r.height,r.getComponent(cc.Sprite).spriteFrame=t.imgs[p],r.width=f,r.height=l,r.active=!0,s.active=!0}i<=a.default.fight.maxIndex&&(cc.find("index",e).getComponent(cc.Label).string=""+i)},this)},r([f(cc.Node)],t.prototype,"scroller",void 0),r([p],t)}(s.default);n.default=l,cc._RF.pop()},{"../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popPower:[function(e,t,n){"use strict";cc._RF.push(t,"bbe5cpDaAJO/L3PrIhfMZId","popPower");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../core/API"),s=e("../../../data/dataManager"),u=e("../../gameManager"),p=e("./basePop"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){u.default.ins.uimain.adjustHierarchy(["start","player","popUp"]),cc.find("count",this.node).getComponent(cc.Label).string=a.formatNum(s.default.gameConf.ADpower)},t.prototype.initEvent=function(){this.compName="popPower",this.events={video:function(){c.default.fullAD({succes:function(){s.default.user.power+=s.default.fight.ADpower}}),u.default.ins.popUp.close()}}},r([l],t)}(p.default));n.default=d,cc._RF.pop()},{"../../../Common":"Common","../../../core/API":"API","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popResurgence:[function(e,t,n){"use strict";cc._RF.push(t,"0e4024JQYNC4aWUwb6nmeDq","popResurgence");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../core/API"),c=e("../../gameManager"),s=e("./basePop"),u=cc._decorator,p=u.ccclass,f=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){var e=this;c.default.ins.popUp.closeBtn.active=!1;var t=cc.find("countDown/time",this.node).getComponent(cc.Label);t.string="3";var n=parseInt(t.string);this.interval=setInterval(function(){--n<0&&e.interval&&(clearInterval(e.interval),e.interval=void 0,c.default.ins.fight.over&&c.default.ins.popUp.close(),c.default.playerDo("boom").ins.popUp.open("lose",c.default.ins.popUp.node.parent,[c.default.ins.popUp.node])),t.string=""+n},1e3)},t.prototype.initEvent=function(){this.compName="popResurgence";var e=this;this.events={video:function(){c.default.ins.fight.over=!1,clearInterval(e.interval),e.interval=void 0,a.default.fullAD({succes:function(){c.default.ins.fight.resurgence(),c.default.ins.popUp.close(),c.default.ins.player.onFightEvent()},fail:function(){c.default.ins.fight.over=!0,c.default.ins.popUp.open("lose",c.default.ins.popUp.node.parent,[c.default.ins.popUp.node])}})},extra:function(){clearInterval(e.interval),a.default.extra({succes:function(){console.log("\u5145\u503c\u6210\u529f\uff01\uff01\uff01"),c.default.ins.popUp.close()},fail:function(){console.log("\u5145\u503c\u5931\u8d25..."),c.default.ins.popUp.close()}})}}},r([p],t)}(s.default));n.default=f,cc._RF.pop()},{"../../../core/API":"API","../../gameManager":"gameManager","./basePop":"basePop"}],popSetting:[function(e,t,n){"use strict";cc._RF.push(t,"5f3c7yehvZGmIV3CUOY6TfI","popSetting");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../core/API"),c=e("../../gameManager"),s=e("./basePop"),u=cc._decorator,p=u.ccclass,f=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sound=!1,t.vibration=!1,t}return i(t,e),t.prototype.onEnable=function(){var e=this;c.default.ins.uimain.adjustHierarchy(["start","player","popUp"]),["sound","vibration"].forEach(function(t){cc.find("btn/"+t+"/on",e.node).active=e[t],cc.find("btn/"+t+"/off",e.node).active=!e[t]})},t.prototype.initEvent=function(){this.compName="popSetting";var e=this;this.events={sound:function(t){e.sound=!e.sound,cc.find("on",t).active=e.sound,cc.find("off",t).active=!e.sound,a.default.mute(e.sound)},vibration:function(t){e.vibration=!e.vibration,cc.find("on",t).active=e.vibration,cc.find("off",t).active=!e.vibration,a.default.vibration(e.vibration)}}},r([p],t)}(s.default));n.default=f,cc._RF.pop()},{"../../../core/API":"API","../../gameManager":"gameManager","./basePop":"basePop"}],popStore:[function(e,t,n){"use strict";cc._RF.push(t,"1d523Mvdf9A/KCvVRaVSFOi","popStore");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./basePop"),c=cc._decorator,s=c.ccclass,u=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){},t.prototype.initEvent=function(){this.compName="popStore",this.events={buy:function(e){console.log(e.parent.name,"buy $:",cc.find("count",e).getComponent(cc.Label).string)},more:function(){console.log("The store has no more merchandise...")}}},r([s],t)}(a.default));n.default=u,cc._RF.pop()},{"./basePop":"basePop"}],popUpgradeArm:[function(e,t,n){"use strict";cc._RF.push(t,"592ebt6nTtHaqIlB1pW7Vms","popUpgradeArm");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../data/dataManager"),s=e("../../gameManager"),u=e("./basePop"),p=cc._decorator,f=p.ccclass,l=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){s.default.ins.popUp.closeBtn.active=!1,s.default.ins.popUp.playerBack=!0,s.default.ins.player.to(cc.v3(0,300)),s.default.ins.uimain.adjustHierarchy(["start","popUp","player"]),this.initArmScroll(cc.find("demo/scroller",this.node))},t.prototype.initArmScroll=function(e,t){if(void 0===t&&(t=this.node),e.getComponent(cc.ScrollView).scrollEvents.length<=0){var n=new cc.Component.EventHandler;n.target=s.default.ins.popUp.node,n.component="popUp",n.handler="onArmScroll",n.customEventData="",e.getComponent(cc.ScrollView).scrollEvents.push(n)}var o=cc.find("content",e),i=cc.color(80,80,80),r=c.default.user.knifeLevel,u=s.default.ins.player.knifeList.data;if(o.childrenCount<=1){o.width=0;var p=o.children[0];p.removeFromParent();for(var f=0,l=c.default.gameConf.knifeUnlock;f<l.length;f++){var d=l[f],h=cc.instantiate(p);h.name=""+d.type;var g=cc.find(d.type+"/tier1",u),y=h.width;h.getComponent(cc.Sprite).spriteFrame=g.getComponent(cc.Sprite).spriteFrame,h.height=g.height*y/h.width,h.width=y,h.color=d.unlock<=r?g.color:i,cc.find("level",h).getComponent(cc.Label).string="lv."+d.unlock,h.setParent(o)}}cc.find("info/demo/level",t).getComponent(cc.Label).string="lv."+(c.default.user.knifeLevel+1),cc.find("info/demo",t).color=cc.find(c.default.user.nextLevelKnifeType+"/tier1",u).color,cc.find("info/ATK/count",t).getComponent(cc.Label).string=""+a.formatNum(c.default.user.nextKnifeAkt),cc.find("info/upgradeArm/count",t).getComponent(cc.Label).string=""+a.formatNum(c.default.user.nextKnifeGold),cc.find("info/upgradeArm",t).getComponent(cc.Button).interactable=c.default.user.gold>=c.default.user.nextKnifeGold},t.prototype.initEvent=function(){this.compName="popUpgradeArm";var e=this;this.events={upgradeArm:function(t){var n=e.node,o=s.default.ins.player.knifeList.data,i=c.default.user.knifeType;if(c.default.user.gold-=c.default.user.nextKnifeGold,c.default.user.knifeLevel++,cc.find("info/demo",n).color=cc.find(c.default.user.nextLevelKnifeType+"/tier1",o).color,cc.find("demo/scroller/content/"+c.default.user.knifeType,n).color=cc.find(c.default.user.knifeType+"/tier1",o).color,c.default.user.knifeType!=i&&s.default.ins.player.refreshKnifeFace(),c.default.user.knifeLevel>=c.default.user.MaxKnifeLevel)console.warn("\u6b66\u5668\u5df2\u5347\u81f3\u6ee1\u7ea7");else{var r=c.default.user.nextKnifeGold;cc.find("info/demo/level",n).getComponent(cc.Label).string="lv."+(c.default.user.knifeLevel+1),cc.find("info/ATK/count",n).getComponent(cc.Label).string=""+a.formatNum(c.default.user.nextKnifeAkt),cc.find("info/upgradeArm/count",n).getComponent(cc.Label).string=""+a.formatNum(r),c.default.user.gold<r&&(t.getComponent(cc.Button).interactable=!1);var u=cc.find("demo/scroller/content/"+c.default.user.knifeType,n),p=cc.find("demo/scroller/content",n),f=cc.find("demo/scroller",n).width/2-u.x;f<0&&cc.tween(p).to(.5,{x:f}).start()}}}},r([f],t)}(u.default));n.default=l,cc._RF.pop()},{"../../../Common":"Common","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popUpgradeHero:[function(e,t,n){"use strict";cc._RF.push(t,"8c054J1GxZK878FYpuluECH","popUpgradeHero");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../data/dataManager"),s=e("../../gameManager"),u=e("./basePop"),p=cc._decorator,f=p.ccclass,l=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){s.default.ins.popUp.closeBtn.active=!1,s.default.ins.popUp.playerBack=!0,this.selectFrame=cc.find("demos/selected",this.node),this.selected=cc.find("demos/"+c.default.user.heroType+"/demo",this.node),this.selectFrame.setPosition(this.selected.x-5,this.selected.y+5),s.default.ins.player.to(cc.v3(0,450)),s.default.ins.uimain.adjustHierarchy(["start","popUp","player"]),this.initHeroPop(this.node)},t.prototype.initHeroPop=function(e){var t=this;void 0===e&&(e=this.node),s.default.ins.player.heroList.data.children.forEach(function(t){var n=cc.find("demos/"+t.name+"/demo/hero",e),o=n.width,i=n.height;n.getComponent(cc.Sprite).spriteFrame=cc.find("hero",t).getComponent(cc.Sprite).spriteFrame,n.width=o,n.height=i});for(var n=function(n){var i=cc.find("demos/"+n.type+"/demo",e);cc.find("level",i).getComponent(cc.Label).string="lv."+c.default.user.heroLevel[n.type];var r=c.default.gameConf.heroUnlock.indexOf(n);if(0!=r){var a=c.default.user.heroLevel[c.default.gameConf.heroUnlock[r-1].type]<n.unlock;cc.find("hero/mask",i).active=a,i.getComponent(cc.Sprite).spriteFrame=a?o.imgs.grayHeroBG:o.imgs.heroBG,cc.find("star",i).children.forEach(function(e){return e.getComponent(cc.Sprite).spriteFrame=a?t.imgs.grayStar:t.imgs.star}),cc.find("lock",i).active=a,i.getComponent(cc.Button).interactable=!a}r!=c.default.gameConf.heroUnlock.length-1&&cc.find("lines",i).children.forEach(function(e){return e.getComponent(cc.Sprite).spriteFrame=c.default.user.heroLevel[n.type]<c.default.gameConf.heroUnlock[r+1].unlock?t.imgs.dash:t.imgs.solid})},o=this,i=0,r=c.default.gameConf.heroUnlock;i<r.length;i++)n(r[i]);cc.find("info/ATK/count",e).getComponent(cc.Label).string=""+Math.round(c.default.user.nextHeroAkt),cc.find("info/upgradeHero/count",e).getComponent(cc.Label).string=""+a.formatNum(c.default.user.upHeroGold),cc.find("info/upgradeHero",e).getComponent(cc.Button).interactable=c.default.user.gold>=c.default.user.upHeroGold;var u=cc.find("effect",this.node);cc.find("tex01",u).getComponent(cc.Animation).stop();var p=cc.v3(0,0),f=cc.v3(0,0);s.default.ins.player.node.parent.convertToWorldSpaceAR(s.default.ins.player.node.position,p),this.node.convertToNodeSpaceAR(p,f),u.setPosition(f),u.active=!1},t.prototype.initEvent=function(){this.compName="popUpgradeHero";var e=this;this.events={demo:function(t){if(e.selected!=t){var n=e.node;e.selectFrame.setPosition(t.x-5,t.y+5),e.selected=t;var o=t.parent.name;c.default.user.heroType=o,cc.find("info/ATK/count",n).getComponent(cc.Label).string=""+Math.round(c.default.user.nextHeroAkt),cc.find("info/upgradeHero/count",n).getComponent(cc.Label).string=""+a.formatNum(c.default.user.upHeroGold),cc.find("info/upgradeHero",n).getComponent(cc.Button).interactable=c.default.user.gold>=c.default.user.upHeroGold,s.default.ins.player.changeHeroFace(o)}},upgradeHero:function(t){if(c.default.user.currHeroLevel>=c.default.user.MaxHeroLevel)console.warn("\u89d2\u8272\u5df2\u5347\u81f3\u6ee1\u7ea7\uff01\uff01\uff01");else{var n=e.node;if(c.default.user.gold-=c.default.user.upHeroGold,c.default.user.currHeroLevel++,cc.find("info/ATK/count",n).getComponent(cc.Label).string=""+Math.round(c.default.user.nextHeroAkt),cc.find("info/upgradeHero/count",n).getComponent(cc.Label).string=""+a.formatNum(c.default.user.upHeroGold),c.default.user.gold<c.default.user.upHeroGold&&(t.getComponent(cc.Button).interactable=!1),cc.find("demos/"+c.default.user.heroType+"/demo/level",n).getComponent(cc.Label).string="lv."+(c.default.user.currHeroLevel+1),c.default.user.currHeroLevel>=c.default.user.nextHeroUnlock){var o=cc.find("demos/"+c.default.user.nextHeroType+"/demo",n);cc.find("hero/mask",o).active=!1,cc.find("star",o).children.forEach(function(t){return t.getComponent(cc.Sprite).spriteFrame=e.imgs.star}),cc.find("lines",e.selected).children.forEach(function(t){return t.getComponent(cc.Sprite).spriteFrame=e.imgs.solid}),cc.find("lock",o).active=!1,o.getComponent(cc.Sprite).spriteFrame=e.imgs.heroBG,o.getComponent(cc.Button).interactable=!0}var i=cc.find("effect",e.node),r=cc.find("tex01",i).getComponent(cc.Animation),u=cc.v3(0,0),p=cc.v3(0,0);s.default.ins.player.node.parent.convertToWorldSpaceAR(s.default.ins.player.node.position,u),e.node.convertToNodeSpaceAR(u,p),i.setPosition(p),i.active||(i.active=!0),r.on(cc.Animation.EventType.FINISHED,function(){i.active=!1,r.off(cc.Animation.EventType.FINISHED)}),r.play(r.getClips()[0].name)}}}},r([f],t)}(u.default));n.default=l,cc._RF.pop()},{"../../../Common":"Common","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],popUp:[function(e,t,n){"use strict";cc._RF.push(t,"d13e18BBdlH7IoKYXoPCPeG","popUp");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../core/LoadRes"),u=e("../../data/dataManager"),p=e("../gameManager"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.preRootPath="Prefabs/view/pop/",t.pops={},t.nodeList=[],t.zIList=[],t.lightNodeMap=new Map,t}return i(t,e),t.prototype.onLoad=function(){p.default.ins.popUp=this,this.initEvent(),this.popView=cc.find("popView",this.node),this.lightView=cc.find("lightView",this.node),this.closeBtn=cc.find("close",this.node),this.node.active=!1},t.prototype.onDisable=function(){u.default.saveData()},t.prototype.getPop=function(e){return a(this,void 0,void 0,function(){var t,n,o;return c(this,function(i){switch(i.label){case 0:return null==(t=this.pops[e])&&(t=cc.find(e,this.popView)),null!=t?[3,2]:(o=(n=cc).instantiate,[4,s.default.get(""+this.preRootPath+e,cc.Prefab)]);case 1:(t=o.apply(n,[i.sent()]))&&(this.pops[e]=t,t.setParent(this.popView)),i.label=2;case 2:return null==t&&cc.warn("Can't found "+e+"!!!"),[2,t]}})})},t.prototype.open=function(e,t){return a(this,void 0,void 0,function(){var n,o,i,r=this;return c(this,function(a){switch(a.label){case 0:return this.node.children.forEach(function(e){var t=e.getComponent(cc.Widget);t&&t.updateAlignment()}),t&&t.forEach(function(e){r.lightNodeMap.has(e.parent)?r.lightNodeMap.get(e.parent).push(e):r.lightNodeMap.set(e.parent,[e]),e.setParent(r.lightView);var t=e.getComponent(cc.Widget);t&&t.updateAlignment()}),this.node.active=!0,this.closeBtn.active=!0,this.currPop&&(this.currPop.active=!1,this.currPop=void 0),[4,this.getPop(e)];case 1:return n=a.sent(),this.currPop=n,this.currPop.active=!0,this.closeBtn.setParent(this.currPop),(o=this.currPop.getComponent(cc.Widget))&&o.updateAlignment(),(i={x:0,y:0}).x=this.currPop.width*(1-this.currPop.anchorX),i.y=this.currPop.height*(1-this.currPop.anchorY),i.x>p.default.ins.canvas.width/2-this.closeBtn.width&&(i.x=p.default.ins.canvas.width/2-this.closeBtn.width),this.closeBtn.setPosition(0,0),cc.tween(this.closeBtn).by(.15,{x:i.x,y:i.y}).start(),this.currPop.scale=0,cc.tween(this.currPop).to(.15,{scale:1}).start(),[2]}})})},t.prototype.close=function(){this.lightNodeMap.forEach(function(e,t){var n=t.getComponent(cc.Widget);n&&n.updateAlignment(),e.forEach(function(e){e.setParent(t);var n=e.getComponent(cc.Widget);n&&(n.updateAlignment(),setTimeout(function(){n.updateAlignment()},80))})}),this.lightNodeMap.clear(),this.node.active=!1,p.default.ins.player.node.parent!=p.default.ins.canvas&&p.default.ins.player.node.setParent(p.default.ins.canvas),this.playerBack&&(this.playerBack=!1,p.default.ins.player.to()),p.default.ins.uimain&&p.default.ins.uimain.adjustHierarchy(["start","player","popUp"])},t.prototype.onClick=function(e){e.target.name==e.currentTarget.name&&(null==this.events[e.target.name]?console.warn("No event is added to the \"'"+self.name+"'\" button!!!"):this.events[e.target.name](e.target))},t.prototype.initEvent=function(){var e=this;this.events={close:function(){e.close()}};var t=new cc.Component.EventHandler;t.target=this.node,t.component="popUp",t.handler="onClick",this.node.getComponentsInChildren(cc.Button).forEach(function(e){return e.clickEvents.push(t)})},r([l],t)}(cc.Component));n.default=d,cc._RF.pop()},{"../../core/LoadRes":"LoadRes","../../data/dataManager":"dataManager","../gameManager":"gameManager"}],popWin:[function(e,t,n){"use strict";cc._RF.push(t,"c9f59fZHZdKSpXpu2yR758m","popWin");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Common"),c=e("../../../core/API"),s=e("../../../data/dataManager"),u=e("../../gameManager"),p=e("./basePop"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onEnable=function(){u.default.ins.popUp.closeBtn.active=!1,u.default.ins.popUp.computedGold=u.default.ins.fight.computedGold(),cc.find("content/count",this.node).getComponent(cc.Label).string=""+a.formatNum(u.default.ins.popUp.computedGold),cc.find("video/multiple",this.node).getComponent(cc.Label).string="x1"},t.prototype.initEvent=function(){this.compName="popWin",this.events={receive:function(){s.default.user.gold+=u.default.ins.popUp.computedGold,s.default.fight.currIndex++,u.default.ins.popUp.close(),u.default.ins.uifight.back()},video:function(){s.default.fight.currIndex++,u.default.ins.popUp.close(),u.default.ins.uifight.back()},extra:function(){c.default.extra({succes:function(){console.log("\u5145\u503c\u6210\u529f\uff01\uff01\uff01"),u.default.ins.popUp.close()},fail:function(){console.log("\u5145\u503c\u5931\u8d25..."),u.default.ins.popUp.close()}})}}},r([l],t)}(p.default));n.default=d,cc._RF.pop()},{"../../../Common":"Common","../../../core/API":"API","../../../data/dataManager":"dataManager","../../gameManager":"gameManager","./basePop":"basePop"}],start:[function(e,t,n){"use strict";cc._RF.push(t,"69c77e7xehHw5qsWMaJ1CPl","start");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../data/dataManager"),u=e("../gameManager"),p=e("../timeManager"),f=cc._decorator,l=f.ccclass,d=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tweenData={maxDelay:0,back:0,list:new Map},t.labelMap=new Map,t}return i(t,e),Object.defineProperty(t.prototype,"speed",{get:function(){var e=u.default.ins.canvas,t=e.width,n=e.height;return Math.max(t,n)/.8},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){u.default.ins.start=this,this.init();var e=u.default.ins.canvas;this.tweenData.list.forEach(function(t,n){var o=e[t.trans]+t.target.close;n.getComponent(cc.Widget).enabled=!1,n[t.trans]=t.plus?o:-o},this),this.node.opacity=0,this.isOpen=!1},t.prototype.start=function(){this.updateInfo(),p.default.run()},t.prototype.onEnable=function(){this.updateInfo(),0==this.isOpen&&this.open().then(function(){var e=u.default.ins.canvas,t=e.height,n=e.anchorY,o=cc.v3(0,-t*n);u.default.ins.player.comeIn(o)})},t.prototype.init=function(){var e=this;this.initTouchEvent(),this.initTweenData(),["top/gold/count","top/power/count","right/earning/count"].forEach(function(t){return e.labelMap.set(t,cc.find(t,e.node))})},t.prototype.updateInfo=function(){var e=this;this.labelMap.forEach(function(e){var t=e.getComponent(cc.Label);t&&(t.string=s.default.user[e.parent.name+"Str"]||"0")}),["passed","last","curr","after","next"].forEach(function(t,n){var o=cc.find("round/info/"+t+"/index",e.node),i=o?o.getComponent(cc.Label):void 0;if(i){var r=s.default.fight.currIndex+n-2;r<=0?o.parent.active=!1:(o.parent.active=!0,i.string=""+r,i.fontSize=r<=99?25:15)}},this)},t.prototype.initTweenData=function(){var e=this;this.node.getComponent(cc.Widget).updateAlignment(),this.tweenData.back=150;var t=u.default.ins.canvas,n={x:250,y:350};[{name:"Logo",delay:0,trans:"y",plus:!0},{name:"round",delay:1,trans:"y",plus:!0},{name:"top",delay:2,trans:"y",plus:!0},{name:"right",delay:0,trans:"x",plus:!0},{name:"clickStart",delay:1,trans:"y",plus:!1},{name:"upgrade",delay:2,trans:"y",plus:!1}].forEach(function(o){o.delay>e.tweenData.maxDelay&&(e.tweenData.maxDelay=o.delay);var i=cc.find(o.name,e.node);i.getComponent(cc.Widget).updateAlignment();var r=o.plus;e.tweenData.list.set(i,{plus:r,delay:o.delay,trans:o.trans,target:{open:t[{x:"width",y:"height"}[o.trans]]/2-Math.abs(i[o.trans]),close:n[o.trans]}})},this)},t.prototype.open=function(){var e=this,t=this.tweenData.back/this.speed;return this.node.opacity=0,new Promise(function(n){return cc.tween(e.node).to(1,{opacity:255}).call(function(){var o=0,i={x:u.default.ins.canvas.width/2,y:u.default.ins.canvas.height/2};e.tweenData.list.forEach(function(r,a){var c,s;o++;var u=i[r.trans]-r.target.open-e.tweenData.back,p=a.getComponent(cc.Widget);cc.tween(a).delay(t*(e.tweenData.maxDelay-r.delay)).to((Math.abs(a[r.trans])-u)/e.speed,(c={},c[r.trans]=r.plus?u:-u,c),{easing:"quadOut"}).by(t,(s={},s[r.trans]=r.plus?e.tweenData.back:-e.tweenData.back,s),{easing:"cubicInOut"}).call(function(){p&&(p.enabled=!0),--o>0||(e.isOpen=!0,n())}).start()})}).start()})},t.prototype.close=function(){var e=this,t=u.default.ins.canvas,n=this.tweenData.back/this.speed,o=0;return new Promise(function(i){return e.tweenData.list.forEach(function(r,s){return a(e,void 0,void 0,function(){var e,a,u,p=this;return c(this,function(){return o++,e=t[r.trans]+r.target.close,cc.tween(s).delay(n*r.delay).by(n,(a={},a[r.trans]=r.plus?-this.tweenData.back:this.tweenData.back,a),{easing:"quadOut"}).to(e/this.speed,(u={},u[r.trans]=r.plus?e:-e,u),{easing:"quadOut"}).call(function(){--o>0||cc.tween(p.node).to(1.5,{opacity:0}).call(function(e){e.active=!1,p.isOpen=!1,i()}).start()}).start(),[2]})})},e)})},t.prototype.onTouch=function(e){e.target.name==e.currentTarget.name&&(this.events[e.target.name]||(this.events[e.target.name]=function(e){console.warn("No event is added to the \"'"+e.name+"'\" button!!!")}),this.events[e.target.name](e.target))},t.prototype.initTouchEvent=function(){var e=this;this.node.getComponentsInChildren(cc.Button).forEach(function(t){var n=new cc.Component.EventHandler;n.target=e.node,n.component="start",n.handler="onTouch",n.customEventData="",t.clickEvents.push(n)});var t=this;this.events={setting:function(){u.default.ins.popUp.open("setting")},roundMap:function(){u.default.ins.popUp.open("map")},addGold:function(){u.default.ins.popUp.open("gold",[cc.find("top/gold",t.node)])},addPower:function(){u.default.ins.popUp.open("power",[cc.find("top/power",t.node)])},getGift:function(){u.default.ins.popUp.open("gift",["gold","power"].reduce(function(e,n){return e.push(cc.find("top/"+n,t.node)),e},[]))},earning:function(){p.default.earningStore&&u.default.ins.popUp.open("earning",[cc.find("top/gold",t.node)])},upgradeArm:function(e){u.default.ins.popUp.node.active?u.default.ins.popUp.close():u.default.ins.popUp.open("upgradeArm",[e])},upgradeHero:function(e){u.default.ins.popUp.node.active?u.default.ins.popUp.close():u.default.ins.popUp.open("upgradeHero",[e])},clickStart:function(){if(s.default.user.power<s.default.fight.outPower)u.default.ins.popUp.open("power",[cc.find("top/power",t.node)]);else{s.default.user.power-=s.default.fight.outPower;var e=u.default.ins.canvas,n=e.height*(1-e.anchorY)+150;t.close().then(function(){u.default.ins.player.leave(u.default.ins.player.node.position,cc.v3(0,n)).then(function(){u.default.clearIns(),cc.director.loadScene("UIFight")})})}},store:function(){u.default.ins.popUp.open("store")}}},r([l],t)}(cc.Component));n.default=d,cc._RF.pop()},{"../../data/dataManager":"dataManager","../gameManager":"gameManager","../timeManager":"timeManager"}],timeManager:[function(e,t,n){"use strict";cc._RF.push(t,"554657kfx5NA7ru84VR4hsX","timeManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Common"),i=e("../data/dataManager"),r=e("./gameManager"),a=function(){function e(){}return Object.defineProperty(e,"powerLabe",{get:function(){return!e._powerLabel&&r.default.ins.start&&(e._powerLabel=cc.find("top/power/time",r.default.ins.start.node).getComponent(cc.Label)),e._powerLabel},enumerable:!1,configurable:!0}),Object.defineProperty(e,"learningProgress",{get:function(){return!e._learningProgress&&r.default.ins.start&&(e._learningProgress=cc.find("right/earning",r.default.ins.start.node).getComponent(cc.ProgressBar)),e._learningProgress},enumerable:!1,configurable:!0}),Object.defineProperty(e,"learningLabel",{get:function(){return!e._learningLabel&&r.default.ins.start&&(e._learningLabel=cc.find("right/earning/count",r.default.ins.start.node).getComponent(cc.Label)),e._learningLabel},enumerable:!1,configurable:!0}),e.run=function(){e.interval=setInterval(e.clock,100)},e.stop=function(){clearInterval(e.interval)},e.clearTimer=function(){e._learningLabel=void 0,e._learningProgress=void 0,e._powerLabel=void 0},Object.defineProperty(e,"earningStore",{get:function(){return c.ins.learningStore||0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"earningStoreFull",{get:function(){return c.ins.learningStore==c.ins.learningStoreMax},enumerable:!1,configurable:!0}),e.clock=function(){e.now=Date.now(),e.powerClock(),e.learningClock()},e.transMS=function(e){var t=e/1e3,n=Math.floor(t%60),o=Math.floor(t/60%60);return(o>9?o:"0"+o)+":"+(n>9?n:"0"+n)},e.powerClock=function(){if(e.powerLabe)if(i.default.user.power>=c.ins.powerMax)c.ins.powerTime=void 0,e.powerLabe.node.active=!1;else if(c.ins.powerTime||(c.ins.powerTime=e.now,c.ins.save()),e.now<c.ins.powerTimeEnd){var t=e.transMS(c.ins.powerTimeEnd-e.now);e.powerLabe.node.active||(e.powerLabe.node.active=!0),e.powerLabe.string=t+"  +1"}else{var n=e.now-c.ins.powerTime,o=Math.floor(n/c.ins.powerTimeStep);c.ins.powerTime+=o*c.ins.powerTimeStep,i.default.user.power+o*c.ins.powerIncrement>c.ins.powerMax?i.default.user.power=c.ins.powerMax:i.default.user.power+=o*c.ins.powerIncrement,c.ins.save()}},e.learningClock=function(){if(e.learningLabel&&e.learningProgress&&!e.earningStoreFull)if(c.ins.learningStore>c.ins.learningStoreMax)c.ins.learningTime=void 0,c.ins.learningStore=c.ins.learningStoreMax,e.learningProgress.progress=1,null!=c.ins.learningStore&&(e.learningLabel.string=o.formatNum(c.ins.learningStore)),c.ins.save();else if(c.ins.learningTime||(c.ins.learningTime=e.now,c.ins.save()),e.now<c.ins.learningTimeEnd){var t=e.now-c.ins.learningTime;e.learningProgress.progress=t/c.ins.learningTimeStep}else{t=e.now-c.ins.learningTime;var n=Math.floor(t/c.ins.learningTimeStep);c.ins.learningTime+=n*c.ins.learningTimeStep,c.ins.learningStore||(c.ins.learningStore=0),c.ins.learningStore+=n*c.ins.learningIncrement,null!=c.ins.learningStore&&(e.learningLabel.string=o.formatNum(c.ins.learningStore)),c.ins.save()}},e.receiveEarningGold=function(){i.default.user.gold+=c.ins.learningStore,c.ins.learningStore=0,e.learningLabel.string="0",c.ins.save()},e}();n.default=a;var c=function(){function e(){this.powerIncrement=1,this.powerMax=60,this.powerTimeStep=12e4,this.learningTimeStep=6e4;var e=localStorage.getItem("spinMaster-timer");if(e=JSON.parse(e))for(var t in e)this[t]=e[t]}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e.prototype.save=function(){localStorage.setItem("spinMaster-timer",JSON.stringify(e.ins)),i.default.saveData()},Object.defineProperty(e.prototype,"powerTimeEnd",{get:function(){return this.powerTime+this.powerTimeStep},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"learningTimeEnd",{get:function(){return this.learningTime+this.learningTimeStep},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"learningIncrement",{get:function(){return i.default.roundConf.numData[i.default.fight.currIndex-1].learningStep},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"learningStoreMax",{get:function(){return i.default.roundConf.numData[i.default.fight.currIndex-1].learningStoreMax},enumerable:!1,configurable:!0}),e}();cc._RF.pop()},{"../Common":"Common","../data/dataManager":"dataManager","./gameManager":"gameManager"}]},{},["Init","Common","Loading","UIFight","UIMain","API","LoadRes","dataManager","Buff","TouchFollow","bullet","knife","gameManager","Boss","Mon","Pet","monster","player","timeManager","fight","popUp","basePop","popEarning","popGift","popGold","popLose","popMap","popPower","popResurgence","popSetting","popStore","popUpgradeArm","popUpgradeHero","popWin","start"]);